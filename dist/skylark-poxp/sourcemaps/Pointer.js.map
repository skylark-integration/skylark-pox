{"version":3,"sources":["Pointer.js"],"names":["define","pox","Pointer","t","cb","touch","gesture","EV_S","EV_E","EV_M","self","this","pos","ev","x","y","touches","length","pageX","target","offsetLeft","pageY","offsetTop","offsetX","offsetY","startev","type","EV_O","addEventListener","c","d","lastd","mf","up","ex","ey","dx","dy","preventDefault","out","s","move","ox","oy","first","down","sx","sy","contextmenu","px","py","wheel","deltaY","scale","rotation","gyro","window","rx","ry","rz","or","orientation","gamma","alpha","beta"],"mappings":"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","file":"../Pointer.js","sourcesContent":["define([\n    \"./pox\"\n],function(pox){\n\t//mouse and touch event handler\n\tvar Pointer = function(t,cb) {\n\t\tvar self = this ;\n\t\tvar touch,gesture,EV_S,EV_E,EV_M ;\n\t\tfunction pos(ev) {\n\t\t\tvar x,y ;\n\t\t\tif(touch && ev.touches.length>0) {\n\t\t\t\tx = ev.touches[0].pageX - ev.target.offsetLeft ;\n\t\t\t\ty = ev.touches[0].pageY - ev.target.offsetTop ;\n\t\t\t} else {\n\t\t\t\tx = ev.offsetX ;\n\t\t\t\ty = ev.offsetY ;\n\t\t\t}\n\t\t\treturn {x:x,y:y} ;\n\t\t}\n\t\tt.addEventListener(\"mousedown\", startev,false ) ;\n\t\tt.addEventListener(\"touchstart\", startev,false ) ;\n\t\tfunction startev(ev) {\n\t\t\tif(gesture) return ;\n\t\t\tif(!EV_S) {\n\t\t\t\ttouch = (ev.type==\"touchstart\") ;\n\t\t\t\tsetevent() ;\n\t\t\t\tfirst = false ;\n\t\t\t}\n\t\t\tself.mf = true ;\n\t\t\tself.dx = self.dy = 0 ;\n\t\t\tself.s = pos(ev) ;\n\t\t\tself.lastd = self.s ;\n\t\t\tif(cb.down) if(!cb.down({x:self.s.x,y:self.s.y,sx:self.s.x,sy:self.s.y})) ev.preventDefault() ;\t\n\t\t}\n\t\tfunction setevent() {\n\t\t\tif(touch) {\n\t\t\t\tEV_S = \"touchstart\" ;\n\t\t\t\tEV_E = \"touchend\" ;\n\t\t\t\tEV_O = \"touchcancel\" ;\n\t\t\t\tEV_M = \"touchmove\" ;\n\t\t\t} else {\n\t\t\t\tEV_S = \"mousedown\" ;\n\t\t\t\tEV_E = \"mouseup\" ;\n\t\t\t\tEV_O = \"mouseout\" ;\n\t\t\t\tEV_M = \"mousemove\" ;\t\n\t\t\t}\n\t\t\tt.addEventListener(EV_E, function(ev) {\n\t\t\t\tvar c = pos(ev) ;\n\t\t\t\tvar d = (ev.type==\"touchend\")?self.lastd:pos(ev) ;\n\t\t\t\tself.mf = false ;\n\t\t\t\tif(cb.up) if(!cb.up({x:c.x,y:c.y,ex:d.x,ey:d.y,dx:self.dx,dy:self.dy})) ev.preventDefault() ;\n\t\t\t},false);\n\t\t\tt.addEventListener(EV_O, function(ev) {\n\t\t\t\tself.mf = false ;\n\t\t\t\tvar c = pos(ev) ;\n\t\t\t\tif(cb.out) if(!cb.out({x:c.x,y:c.y,dx:self.dx,dy:self.dy})) ev.preventDefault() ;\n\t\t\t},false);\n\t\t\tt.addEventListener(EV_M, function(ev) {\n\t\t\t\tif(gesture) return ;\n\t\t\t\tvar d = pos(ev) ;\n\t\t\t\tself.lastd = d ;\n\t\t\t\tif(self.mf) {\n\t\t\t\t\tself.dx = (d.x-self.s.x) ;\n\t\t\t\t\tself.dy = (d.y-self.s.y) ;\n\t\t\t\t\tif(cb.move) if(!cb.move({x:d.x,y:d.y,ox:d.x,oy:d.y,dx:self.dx,dy:self.dy})) ev.preventDefault() ;\n\t\t\t\t}\n\t\t\t},false)\t\n\t\t}\n\t\tif(cb.contextmenu) {\n\t\t\tt.addEventListener(\"contextmenu\", function(ev){\n\t\t\t\tif(!cb.contextmenu({px:ev.offsetX,py:ev.offsetY})) ev.preventDefault() ;\n\t\t\t},false )\n\t\t}\n\t\tif(cb.wheel) {\n\t\t\tt.addEventListener(\"wheel\", function(ev){\n\t\t\t\tif(!cb.wheel(ev.deltaY)) ev.preventDefault() ;\n\t\t\t},false ) ;\n\t\t}\n\t\tif(cb.gesture) {\n\t\t\tt.addEventListener(\"gesturestart\", function(ev){\n\t\t\t\tgesture = true ;\n\t\t\t\tif(!cb.gesture(0,0)) ev.preventDefault() ;\n\t\t\t})\n\t\t\tt.addEventListener(\"gesturechange\", function(ev){\n\t\t\t\n\t\t\t\tif(!cb.gesture(ev.scale,ev.rotation)) ev.preventDefault() ;\n\t\t\t})\n\t\t\tt.addEventListener(\"gestureend\", function(ev){\n\t\t\t\tgesture = false ;\n\t\t\t})\n\t\t}\n\t\tif(cb.gyro) {\n\t\t\twindow.addEventListener(\"deviceorientation\", function(ev) {\n\t\t\t\tvar or = window.orientation ;\n\t\t\t\tvar rx,ry,rz ;\n\t\t\t\trx = null ;ry = null; rz = null ;\n\t\t\t\tswitch( or ){\n\t\t\t\t\tcase 90:\n\t\t\t\t\t\tif(ev.gamma<0) {\n\t\t\t\t\t\t\trx = ev.gamma+90 ;\n\t\t\t\t\t\t\try = 180-ev.alpha ;\n\t\t\t\t\t\t\trz = ev.beta+180 ;\t\t\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trx = ev.gamma-90 ;\n\t\t\t\t\t\t\try = 360-ev.alpha ;\n\t\t\t\t\t\t\trz = ev.beta ;\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak ;\n\t\t\t\t\tcase -90:\n\t\t\t\t\t\tif(ev.gamma<0) {\n\t\t\t\t\t\t\trx = -ev.gamma-90 ;\n\t\t\t\t\t\t\try = 180-ev.alpha ;\n\t\t\t\t\t\t\trz = -ev.beta+180 ;\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trx = -ev.gamma+90 ;\n\t\t\t\t\t\t\try = 360-ev.alpha ;\n\t\t\t\t\t\t\trz = -ev.beta ;\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak ;\t\n\t\t\t\t\tdefault:\n\t\t\t\n\t\t\t\t}\n\n\t\t\t\tcb.gyro({rx:rx,ry:ry,rz:rz,orientation:or}) ;\n\t\t\t})\n\t\t}\n\t}\n\n\n\treturn pox.Pointer = Pointer;\n});\n"]}
/**
 * skylark-poxp - A version of poxp that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-poxp/
 * @license MIT
 */
define(["./pox"],function(t){return WBind={},WBind.create=function(t){var e=new WBind.obj;if(void 0!==t)for(var i in t)e[i]=t[i];return e},WBind.obj=function(){this.prop={},this._elem={},this._check={},this._func={},this._tobjs={}},WBind._getobj=function(t,e){var i;return e||(e=document),"string"==typeof t?(1==(i=e.querySelectorAll(t)).length&&(i=i[0]),0==i.length&&(i=null)):i=t,i},WBind._getval=function(t){var e=t.value;if("checkbox"==t.type&&(e=t.checked),"select-multiple"==t.type){var i=t.querySelectorAll("option");e=[];for(var n=0;n<i.length;n++)i[n].selected&&e.push(i[n].value)}return"range"==t.type&&(e=parseFloat(e)),e},WBind.obj.prototype.bindHtml=function(t,e,i){var n=WBind._getobj(e);return n?(this._elem[t]=n,i||(i={}),this._func[t]=i,Object.defineProperty(this,t,{configurable:!0,get:function(){return n instanceof NodeList||Array.isArray(n)?this.prop[t]=n[0].innerHTML:this.prop[t]=n.innerHTML,this.prop[t]},set:function(e){if(this._func[t].set&&(e=this._func[t].set(e)),this.prop[t]=e,n instanceof NodeList||Array.isArray(n))for(var i=0;i<n.length;i++)this._elem[t][i].innerHTML=e;else this._elem[t].innerHTML=e}}),n instanceof NodeList||Array.isArray(n)?this.prop[t]=n[0].innerHTML:this.prop[t]=n.innerHTML,this):this},WBind.obj.prototype.bindStyle=function(t,e,i,n){var r=WBind._getobj(e);return r?(this._elem[t]=r,n||(n={}),this._func[t]=n,Object.defineProperty(this,t,{configurable:!0,get:function(){return r instanceof NodeList||Array.isArray(r)?this.prop[t]=r[0].style[i]:this.prop[t]=r.style[i],this.prop[t]},set:function(e){if(this._func[t].set&&(e=this._func[t].set(e)),this.prop[t]=e,r instanceof NodeList||Array.isArray(r))for(var n=0;n<r.length;n++)this._elem[t][n].style[i]=e;else this._elem[t].style[i]=e}}),r instanceof NodeList||Array.isArray(r)?this.prop[t]=r[0].style[i]:this.prop[t]=r.style[i],this):this},WBind.obj.prototype.bindAttr=function(t,e,i,n){var r=WBind._getobj(e);return r?(this._elem[t]=r,n||(n={}),this._func[t]=n,Object.defineProperty(this,t,{configurable:!0,get:function(){return r instanceof NodeList||Array.isArray(r)?this.prop[t]=r[0].getAttribute(i):this.prop[t]=r.getAttribute(i),this.prop[t]},set:function(e){if(this._func[t].set&&(e=this._func[t].set(e)),this.prop[t]=e,r instanceof NodeList||Array.isArray(r))for(var n=0;n<r.length;n++)this._elem[t][n].setAttribute(i,e);else this._elem[t].setAttribute(i,e)}}),r instanceof NodeList||Array.isArray(r)?this.prop[t]=r[0].getAttribute(i):this.prop[t]=r.getAttribute(i),this):this},WBind.obj.prototype.bindInput=function(t,e,i){var n=WBind._getobj(e);if(!n)return this;i||(i={}),this._func[t]=i,(n instanceof NodeList||Array.isArray(n))&&"checkbox"!=n[0].type&&"radio"!=n[0].type&&(n=n[0]);var r=void 0!=this.prop[t];this._elem[t]=n,Object.defineProperty(this,t,{configurable:!0,get:function(){var e=a(t);return this._func[t].get&&(e=this._func[t].get(e)),e},set:function(e){this._func[t].set&&(e=this._func[t].set(e)),this.prop[t]=e,function(t,e){var i=o._elem[t];if(i instanceof NodeList||Array.isArray(i)){if("radio"==i[0].type)for(var n=0;n<i.length;n++)i[n].value==e&&(i[n].checked=!0);else if("checkbox"==i[0].type){for(var r={},n=0;n<e.length;n++)r[e[n]]=!0;for(var n=0;n<i.length;n++)i[n].checked=r[i[n].value];o._check[t]=r}}else if("checkbox"==i.type)i.checked=e;else if("select-multiple"==i.type)for(var s=i.querySelectorAll("option"),n=0;n<s.length;n++){s[n].selected=!1;for(var c=0;c<e.length;c++)s[n].value==e[c]&&(s[n].selected=!0)}else i.value=e}(t,e),this._func[t].change&&this._func[t].change(a(t)),this._func[t].input&&this._func[t].input(a(t))}});var o=this,s=null;if(n instanceof NodeList||Array.isArray(n)){"checkbox"==n[0].type&&(o._check[t]={});for(var c=0;c<n.length;c++)"object"==typeof n[c]&&(r||n[c].addEventListener("change",function(e){var i;"checkbox"==this.type?(o._check[t][this.value]=this.checked,i=a(t)):i=this.value,o.prop[t]=i,o._func[t].get&&(i=o._func[t].get(i)),WBind.log("get "+t+"="+i),o._func[t].change&&o._func[t].change(i)}),"radio"==n[c].type&&n[c].checked?s=n[c].value:"checkbox"==n[c].type&&(o._check[t][n[c].value]=n[c].checked));"checkbox"==n[0].type&&(s=a(t))}else s=WBind._getval(n),r||n.addEventListener("change",function(e){var i=WBind._getval(this);o.prop[t]=i,o._func[t].get&&(i=o._func[t].get(i)),o._func[t].change&&o._func[t].change(i)}),r||n.addEventListener("input",function(e){var i=WBind._getval(this);o.prop[t]=i,o._func[t].get&&(i=o._func[t].get(i)),o._func[t].input&&o._func[t].input(i)});function a(t){var e;if(o._check[t]){for(var i in e=[],o._check[t])o._check[t][i]&&e.push(i);o.prop[t]=e}else e=o.prop[t];return e}return this._func[t].get&&(s=this._func[t].get(s)),this.prop[t]=s,o._func[t].input&&this._func[t].input(s),o._func[t].change&&this._func[t].change(s),this},WBind.obj.prototype.getCheck=function(t){return this._check[t]},WBind.obj.prototype.setFunc=function(t,e){for(var i in e)this._func[t][i]=e[i];var n=WBind._getval(this._elem[t]);return this._func[t].get&&(n=this._func[t].get(n)),this.prop[t]=n,this._func[t]},WBind.obj.prototype.bindAllInput=function(t){t||(t=document);for(var e=t.querySelectorAll("input,select,textarea"),i={},n=0;n<e.length;n++){var r=e[n].name;i[r]?Array.isArray(i[r])?i[r].push(e[n]):i[r]=[i[r],e[n]]:i[r]=e[n]}for(var n in i)this.bindInput(n,i[n]);return i},WBind.obj.prototype.bindAll=function(t,e){null==e&&(e=document);for(var i=e.querySelectorAll(t),n=0;n<i.length;n++){var r=i[n].getAttribute("data-bind");"INPUT"==i[n].tagName||"SELECT"==i[n].tagName?this.bindInput(r,i[n]):this.bindHtml(r,i[n])}},WBind.obj.prototype.setTimer=function(t,e,i,n){if(Array.isArray(e))return this.setTimerM(t,e);var r;n||(n={});if(r=n.from?n.from:this[t],isNaN(r)&&(r.match(/^([0-9\-\.]+)(.*)$/)?(r=parseFloat(RegExp.$1),n.sfx=RegExp.$2):r=0),r==e)return this;var o=0;n.delay&&(o=n.delay);var s=(new Date).getTime(),c={from:r,to:e,st:s+o,et:s+o+i,opt:n};return this._tobjs[t]={tl:[c],tc:0},this},WBind.obj.prototype.setTimerM=function(t,e){for(var i=[],n=(new Date).getTime(),r=this[t],o=0;o<e.length;o++){var s=e[o].to,c=e[o].time,a=e[o].opt;a||(a={});isNaN(r)&&(r.match(/^([0-9\-\.]+)(.*)$/)?(r=parseFloat(RegExp.$1),a.sfx=RegExp.$2):r=0);var f=0;a.delay&&(f=a.delay),i.push({from:r,to:s,st:n+f,et:n+f+c,opt:a}),r=s}return this._tobjs[t]={tl:i,tc:0},console.log(i),this},WBind.obj.prototype.clearTimer=function(t){delete this._tobjs[t]},WBind.obj.prototype.updateTimer=function(){var t=(new Date).getTime();for(var e in this._tobjs){var i=this._tobjs[e],n=i.tl[i.tc];if(void 0!==n&&!(n.st>t))if(n.et<=t){var r=n.to;n.opt.sfx&&(r+=n.opt.sfx),this[e]=r,i.tc++,this._tobjs[e].tl.length<i.tc&&delete this._tobjs[e],n.opt.efunc&&n.opt.efunc(n.to)}else{var o=(t-n.st)/(n.et-n.st);if(n.opt.tfunc)if("string"==typeof n.opt.tfunc)switch(n.opt.tfunc){case"ease-in":o*=o;break;case"ease-out":o*=2-o;break;case"ease-inout":o=o*o*(3-2*o)}else o=n.opt.tfunc(o);r=n.from+(n.to-n.from)*o;n.opt.sfx&&(r+=n.opt.sfx),this[e]=r}}},WBind.log=function(t){console.log(t)},WBind.addev=function(t,e,i,n){var r=WBind._getobj(t,n);if(r){r instanceof NodeList||Array.isArray(r)||(r=[r]);for(var o=0;o<r.length;o++)r[o].addEventListener(e,function(t){i(t)||t.preventDefault()})}},WBind.set=function(t,e){e||(e=document),t instanceof Array||(t=[t]);for(var i=0;i<t.length;i++){var n,r=t[i];if(r.obj&&(n=WBind._getobj(r.obj,e)),r.id&&(n=e.getElementById(r.id)),r.sel&&(n=e.querySelectorAll(r.sel)),n){n instanceof NodeList||Array.isArray(n)||(n=[n]);for(var o=0;o<n.length;o++)if(void 0!=r.html&&(n[o].innerHTML=r.html),void 0!=r.value&&(n[o].value=r.value),void 0!=r.attr&&n[o].setAttribute(r.attr,r.value),void 0!=r.style)for(s in r.style)n[o].style[s]=r.style[s]}}},t.WBind=WBind});
//# sourceMappingURL=sourcemaps/WBind.js.map

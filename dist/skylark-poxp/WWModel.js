/**
 * skylark-poxp - A version of poxp that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-poxp/
 * @license MIT
 */
define(["./poxp","./CanvasMatrix4"],function(t,e){t.$;class s{primitive(t,s){s||(s={});let h=s.wx?s.wx:1,o=s.wy?s.wy:1,n=s.wz?s.wz:1,l=s.div?s.div:10,r=s.divx?s.divx:l,a=s.divy?s.divy:l,i=s.divz?s.divz:l,p=s.ninv?-1:1,u=[],c=[],f=[],b=[],v=2*Math.PI;switch(t){case"sphere":for(let t=0;t<=l;++t){let e=t/(0+l),s=Math.cos(Math.PI*e),r=Math.sin(Math.PI*e);for(let t=0;t<=2*l;++t){let a=t/(0+2*l),i=Math.cos(v*a)*r,b=Math.sin(v*a)*r;u.push([i*h,s*o,b*n]),c.push([i*p,s*p,b*p]),f.push([p>0?1-a:a,1-e])}}let e=2*l+1;for(let t=0;t<l;++t){let s=t*e;for(let t=0;t<2*l;++t)p>0?b.push([s+t,s+t+1,s+t+e],[s+t+e,s+t+1,s+t+1+e]):b.push([s+t+e,s+t+1,s+t],[s+t+1+e,s+t+1,s+t+e])}break;case"sphere2":const j=s.div?s.div:6,_=Math.PI/2;for(let t=0;t<j;t++){let e=Math.sin(_*t/j),s=Math.cos(_*t/j),l=j-t;for(let r=0;r<=l;r++){let a=Math.cos(_*r/l)*s,i=Math.sin(_*r/l)*s;u.push([a*h,e*o,i*n]),c.push([a,e,i]),f.push([1-r/l/4,.5+t/j/2])}}u.push([0,o,0]),c.push([0,1,0]),f.push([.75,1]);let M=0;for(let t=0;t<j;t++){let e=2*(j-t)-1,s=j-t+1;for(let t=0;t<e;t++){let e=Math.floor(t/2);t%2==0?p>0?b.push([e+M,e+M+s,e+M+1]):b.push([e+M,e+M+1,e+M+s]):p>0?b.push([e+1+M,e+M+s,e+M+s+1]):b.push([e+1+M,e+M+s+1,e+M+s])}M+=s}let x=u.length,y=b.length;for(let t=0;t<x;t++)u.push([u[t][0],-u[t][1],u[t][2]]),c.push([u[t][0],-u[t][1],u[t][2]]),f.push([f[t][0],1-f[t][1]]);for(let t=0;t<y;t++)b.push([b[t][0]+x,b[t][2]+x,b[t][1]+x]);x=u.length,y=b.length;for(let t=0;t<x;t++)u.push([-u[t][0],u[t][1],u[t][2]]),c.push([-u[t][0],u[t][1],u[t][2]]),f.push([1-f[t][0]+.5,f[t][1]]);for(let t=0;t<y;t++)b.push([b[t][0]+x,b[t][2]+x,b[t][1]+x]);x=u.length,y=b.length;for(let t=0;t<x;t++)u.push([u[t][0],u[t][1],-u[t][2]]),c.push([u[t][0],u[t][1],-u[t][2]]),f.push([1-f[t][0],f[t][1]]);for(let t=0;t<y;t++)b.push([b[t][0]+x,b[t][2]+x,b[t][1]+x]);break;case"cylinder":a=s.divy?s.divy:1;for(let t=0;t<=l;++t){let e=t/(0+l),s=Math.sin(v*e)*n,r=Math.cos(v*e)*h,i=2*o/a;for(let t=0;t<=a;t++)u.push([r,t*i-o,s]),c.push([r*p,0,s*p]),f.push([p>0?1-e:e,t/a])}for(let t=0;t<l;t++)for(let e=0;e<a;e++){let s=t*(a+1)+e;p<0?b.push([s,s+(a+1),s+(a+1)+1,s+1]):b.push([s,s+1,s+3,s+2])}s.cap;break;case"ring":a=s.divy?s.divy:1;for(let t=0;t<=l;++t){let e=t/(0+l),s=Math.sin(v*e)*n,r=Math.cos(v*e)*h;for(let t=0;t<a;t++)u.push([r,o,s]),c.push([r*p,0,s*p]),f.push([p>0?1-e:e,1]),u.push([r,-o,s]),c.push([r*p,0,s*p,0]),f.push([p>0?1-e:e,0])}for(let t=0;t<l;t++)p>0?b.push([2*t,2*t+2,2*t+3,2*t+1]):b.push([2*t,2*t+1,2*t+3,2*t+2]);s.cap;break;case"cone":for(let t=0;t<=l;++t){let e=t/(0+l),s=Math.sin(v*e)*n,r=Math.cos(v*e)*h;u.push([0,o,0]),c.push([r*p,0,s*p]),f.push([p>0?1-e:e,1]),u.push([r,-o,s]),c.push([r*p,0,s*p,0]),f.push([p>0?1-e:e,0])}for(let t=0;t<l;t++)p>0?b.push([2*t,2*t+2,2*t+3,2*t+1]):b.push([2*t,2*t+1,2*t+3,2*t+2]);break;case"disc":for(let t=0;t<l;++t){let e=t/(0+l),s=Math.cos(v*e)*n,o=Math.sin(v*e)*h;u.push([o,0,s]),c.push([0,1,0]),f.push([(o/h+1)/2,(s/n+1)/2])}u.push([0,0,0]),c.push([0,1,0]),f.push([.5,.5]);for(let t=0;t<l-1;t++)b.push([t,t+1,l]);b.push([l-1,0,l]);break;case"plane":s.wz?s.wx?(u=[[h,0,n],[h,0,-n],[-h,0,-n],[-h,0,n]],c=[[0,p,0],[0,p,0],[0,p,0],[0,p,0]]):(u=[[0,-o,-n],[0,o,-n],[0,o,n],[0,-o,n]],c=[[p,0,0],[p,0,0],[p,0,0],[p,0,0]]):(u=[[h,-o,0],[h,o,0],[-h,o,0],[-h,-o,0]],c=[[0,0,p],[0,0,p],[0,0,p],[0,0,p]]),f=p>0?[[1,0],[1,1],[0,1],[0,0]]:[[-1,0],[-1,1],[0,1],[0,0]],b=p>0?[[0,1,2],[2,3,0]]:[[2,1,0],[0,3,2]];break;case"box":u=[[h,o,n],[h,-o,n],[-h,-o,n],[-h,o,n],[h,o,-n],[h,-o,-n],[-h,-o,-n],[-h,o,-n],[h,o,n],[h,-o,n],[h,-o,-n],[h,o,-n],[-h,o,n],[-h,-o,n],[-h,-o,-n],[-h,o,-n],[h,o,n],[h,o,-n],[-h,o,-n],[-h,o,n],[h,-o,n],[h,-o,-n],[-h,-o,-n],[-h,-o,n]],c=[[0,0,p],[0,0,p],[0,0,p],[0,0,p],[0,0,-p],[0,0,-p],[0,0,-p],[0,0,-p],[p,0,0],[p,0,0],[p,0,0],[p,0,0],[-p,0,0],[-p,0,0],[-p,0,0],[-p,0,0],[0,p,0],[0,p,0],[0,p,0],[0,p,0],[0,-p,0],[0,-p,0],[0,-p,0],[0,-p,0]],f=1==s.cubemap?[[.75,2/3],[.75,1/3],[1,1/3],[1,2/3],[.5,2/3],[.5,1/3],[.25,1/3],[.25,2/3],[.75,2/3],[.75,1/3],[.5,1/3],[.5,2/3],[0,2/3],[0,1/3],[.25,1/3],[.25,2/3],[.5,1],[.5,2/3],[.25,2/3],[.25,1],[.5,0],[.5,1/3],[.25,1/3],[.25,0]]:[[1,1],[1,0],[0,0],[0,1],[0,1],[0,0],[1,0],[1,1],[0,1],[0,0],[1,0],[1,1],[1,1],[1,0],[0,0],[0,1],[1,0],[1,1],[0,1],[0,0],[1,1],[1,0],[0,0],[0,1]],b=p>0?[[3,1,0],[2,1,3],[4,5,7],[7,5,6],[8,9,11],[11,9,10],[15,13,12],[14,13,15],[16,17,19],[19,17,18],[23,21,20],[22,21,23]]:[[0,1,3],[3,1,2],[7,5,4],[6,5,7],[11,9,8],[10,9,11],[12,13,15],[15,13,14],[19,17,16],[18,17,19],[20,21,23],[23,21,22]];break;case"mesh":return this.parametricModel(function(t,e){return{px:(t-.5)*h,py:0,pz:(e-.5)*n,nx:0,ny:1,nz:0,mu:t,mv:e}},{start:1,end:0,div:r},{start:0,end:1,div:i},{ninv:s.ninv}),this;case"torus":return this.parametricModel(function(t,e){let l=s.sr?s.sr:.5,r=t,a=-e,i=Math.sin(r*v),p=Math.cos(r*v),u=Math.sin(a*v),c=l*u*i,f=l*u*p,b=l*Math.cos(a*v);Math.hypot(c,b,f);return{px:(1*i+1*c)*h,py:1*b*o,pz:(1*p+1*f)*n,nx:0,ny:0,nz:0,mu:t,mv:e}},{start:0,end:1,div:2*r},{start:0,end:1,div:a},{ninv:s.ninv}),this;case"polyhedron":if(!m[s.shape])return null;let w=m[s.shape].v,k=m[s.shape].s,z=0;for(let t=0;t<k.length;t++){let e=0,s=0,h=0,o=[];for(let n=k[t].length-1;n>=0;n--){let l=w[k[t][n]];u.push([l[0],l[2],l[1]]),e+=l[0],s+=l[2],h+=l[1],o.push(z),z++}let n=Math.hypot(e,s,h);for(let o=0;o<k[t].length;o++)c.push([e/n,s/n,h/n]);b.push(o)}f=null;break;case"icosa":w=m.r05.v,k=m.r05.s;for(let t=0;t<w.length;t++){let e=[w[t][0],w[t][2],w[t][1]];u.push(e),c.push(e),d(e)}for(let t=0;t<k.length;t++)p<0?b.push([k[t][0],k[t][1],k[t][2]]):b.push([k[t][0],k[t][2],k[t][1]]);const A=void 0!==s.div?s.div:2;for(let t=0;t<A;t++)g(u,b);for(let t=0;t<u.length;t++)u[t][0]*=h,u[t][1]*=o,u[t][2]*=n}function d(t){let e=Math.atan2(t[2],t[0])/Math.PI/2;f.push([(1-e)%1,1-Math.acos(t[1])/Math.PI])}function g(t,s){let h=t.length,o=s.length;for(let n=0;n<o;n++){let o=s[n][0],l=s[n][1],r=s[n][2],a=t[o],i=t[l],p=t[r],u=e.V3norm(e.V3add(a,i)),f=e.V3norm(e.V3add(i,p)),b=e.V3norm(e.V3add(p,a));t.push(u),t.push(f),t.push(b),c.push(u),c.push(f),c.push(b),d(u),d(f),d(b),s[n]=[o,h,h+2],s.push([h,h+1,h+2]),s.push([l,h+1,h]),s.push([r,h+2,h+1]),h+=3}}return this.obj_v=u,this.obj_n=c,this.obj_t=f,this.obj_i=b,this}parametricModel(t,e,s,h){let o=[],n=[],l=[],r=[],a=h&&h.ninv?-1:1,i=(e.end-e.start)/e.div,p=(s.end-s.start)/s.div;for(let h=0;h<=e.div;h++)for(let r=0;r<=s.div;r++){let u=e.start+i*h,c=s.start+p*r,f=t(u,c);if(o.push([f.px,f.py,f.pz]),void 0!=f.mu&&l.push([f.mu,f.mv]),0==f.nx&&0==f.ny&&0==f.nz){let e=i/10,s=p/10,h=t(u-e,c),o=t(u+e,c),n=(o.px-h.px)/(2*e),l=(o.py-h.py)/(2*e),r=(o.pz-h.pz)/(2*e),a=t(u,c-s),b=t(u,c+s),v=(b.px-a.px)/(2*s),d=(b.py-a.py)/(2*s),g=(b.pz-a.pz)/(2*s),j=l*g-r*d,_=r*v-n*g,m=n*d-l*v,M=Math.hypot(j,_,m);f.nx=j/M,f.ny=_/M,f.nz=m/M}n.push([f.nx*a,f.ny*a,f.nz*a])}let u=s.div+1;for(let t=0;t<e.div;++t){let e=t*u;for(let t=0;t<s.div;++t)a>0?r.push([e+t,e+t+u,e+t+u+1,e+t+1]):r.push([e+t+1,e+t+u+1,e+t+u,e+t])}return this.obj_v=o,this.obj_n=n,l.length>0&&(this.obj_t=l),this.obj_i=r,this}objModel(t,e){let s=this.obj_v,h=this.obj_i,o=this.obj_n,n=this.obj_t,l=this.obj_c,r=[],a=[],i=[],p=[],u=0;o||(this.obj_n=[]);for(let t=0,e=h.length;t<e;t++){let e=h[t];if(!o){let h=[];for(let t=0;t<3;t++)h[t]=s[e[t]];let o=h[1][0]-h[0][0],n=h[1][1]-h[0][1],l=h[1][2]-h[0][2],r=h[2][0]-h[0][0],a=h[2][1]-h[0][1],u=h[2][2]-h[0][2],c=n*u-l*a,f=-o*u+l*r,b=o*a-n*r,v=Math.hypot(c,f,b);c/=v,f/=v,b/=v,i.push([c,f,b]);for(let s=0,h=e.length;s<h;s++)p[e[s]]||(p[e[s]]=[]),p[e[s]].push(t)}for(let t=1,s=e.length-1;t<s;t++)a.push(e[0]),a.push(e[t]),a.push(e[t+1]);u+=e.length}for(let e=0,h=s.length;e<h;e++){r.push(parseFloat(s[e][0])),r.push(parseFloat(s[e][1])),r.push(parseFloat(s[e][2]));let h=0,a=0,u=0;if(o)h=o[e][0],a=o[e][1],u=o[e][2];else if(p[e])for(let t=0;t<p[e].length;t++){let s=p[e][t];h+=i[s][0],a+=i[s][1],u+=i[s][2]}else h=0,a=0,u=0;let c=Math.hypot(h,a,u);if(0==c?(r.push(0),r.push(0),r.push(0)):(r.push(h/c),r.push(a/c),r.push(u/c)),o||this.obj_n.push([h/c,a/c,u/c]),n&&(r.push(parseFloat(n[e][0])),r.push(parseFloat(n[e][1]))),l&&(r.push(parseFloat(l[e][0])),r.push(parseFloat(l[e][1])),r.push(parseFloat(l[e][2]))),t)for(av=0;av<t.length;av++)r=r.concat(t[av].data[e])}this.ibuf=a,this.vbuf=r;let c={mode:"tri",vtx_at:["position","norm"],vtx:r,idx:a};if(n&&c.vtx_at.push("uv"),l&&c.vtx_at.push("color"),t)for(av=0;av<t.length;av++)c.vtx_at.push(t[av].attr);return c}normLines(t){let e=[],s=this.obj_v,h=this.obj_n;void 0==t&&(t=.1);for(let o=0,n=s.length;o<n;o++)e.push(s[o][0]),e.push(s[o][1]),e.push(s[o][2]),e.push(s[o][0]+h[o][0]*t),e.push(s[o][1]+h[o][1]*t),e.push(s[o][2]+h[o][2]*t);return{mode:"lines",vtx_at:["position"],vtx:e}}wireframe(){let t=[],e=this.obj_v,s=this.obj_i;for(let h=0,o=s.length;h<o;h++){let o,n=s[h];for(o=1;o<n.length;o++)t.push(e[n[o-1]][0]),t.push(e[n[o-1]][1]),t.push(e[n[o-1]][2]),t.push(e[n[o]][0]),t.push(e[n[o]][1]),t.push(e[n[o]][2]);t.push(e[n[o-1]][0]),t.push(e[n[o-1]][1]),t.push(e[n[o-1]][2]),t.push(e[n[0]][0]),t.push(e[n[0]][1]),t.push(e[n[0]][2])}return{mode:"lines",vtx_at:["position"],vtx:t}}multMatrix4(t){let s=new e(t).invert().transpose(),h=t.getAsArray();for(let t=0;t<this.obj_v.length;t++){let e=this.obj_v[t],s=h[0]*e[0]+h[4]*e[1]+h[8]*e[2]+h[12],o=h[1]*e[0]+h[5]*e[1]+h[9]*e[2]+h[13],n=h[2]*e[0]+h[6]*e[1]+h[10]*e[2]+h[14];this.obj_v[t]=[s,o,n]}if(this.obj_n){h=s.getAsArray();for(let t=0;t<this.obj_n.length;t++){let e=this.obj_n[t],s=h[0]*e[0]+h[4]*e[1]+h[8]*e[2]+h[12],o=h[1]*e[0]+h[5]*e[1]+h[9]*e[2]+h[13],n=h[2]*e[0]+h[6]*e[1]+h[10]*e[2]+h[14];this.obj_n[t]=[s,o,n]}}}mergeModels(t){let e=this,s=0;for(let h=0;h<t.length;h++){e.obj_v=e.obj_v.concat(t[h].obj_v),e.obj_n=e.obj_n.concat(t[h].obj_n),e.obj_t=e.obj_t.concat(t[h].obj_t);for(let o=0;o<t[h].obj_i.length;o++){let l=t[h].obj_i[o],r=[];for(n=0;n<l.length;n++)r.push(l[n]+s);e.obj_i.push(r)}s+=t[h].obj_v.length}return e}boundbox(){let t=Number.MAX_VALUE,e=t,s=t,h=Number.MIN_VALUE,o=h,n=h;for(let l=0;l<this.obj_v.length;l++){let r=this.obj_v[l];r[0]<t&&(t=r[0]),r[1]<e&&(e=r[1]),r[2]<s&&(s=r[2]),r[0]>h&&(h=r[0]),r[1]>o&&(o=r[1]),r[2]>n&&(n=r[2])}return[[t,e,s],[h,o,n]]}loadAjax(t){return new Promise(function(e,s){let h=new XMLHttpRequest;h.open("get",t,!0),h.responseType="text",h.onload=function(){200==this.status?e(this.response):s("Ajax error:"+this.statusText)},h.onerror=function(){s("Ajax error:"+this.statusText)},h.send()})}static loadLines(t,e,s){s||(s=1e4);const h=new TextDecoder;return new Promise((o,n)=>{if(Array.isArray(t)){for(let s=0;s<t.length;s++)e(t[s]);o(t)}else{if(t.constructor==File){const s=new FileReader;return s.onload=(s=>{const h=s.target.result.split("\n");for(let t=0;t<h.length;t++)e(h[t]);o(t)}),void s.readAsText(t)}fetch(t,{method:"GET"}).then(async t=>{if(t.ok){const n=t.body.getReader(),l=new Uint8Array(s);let r=0;for(;;){const{done:s,value:a}=await n.read();if(s){e(h.decode(l.slice(0,r))),o(t);break}for(const t of a)l[r++]=t,10==t&&(e(h.decode(l.slice(0,r-1))),r=0)}}else n(t)})}})}async loadObj(t,e){return e||(e=1),new Promise((s,h)=>{this.loadAjax(t).then(h=>{let o=h.split("\n"),n=[],l=[],r=[],a=[],i=[],p={},u=0;for(let t=0,s=o.length;t<s;t++){if(o[t].match(/^#/))continue;if(o[t].match(/^eof/))break;let s=o[t].split(/\s+/);if("v"==s[0]&&(n.push([s[1]*e,s[2]*e,s[3]*e]),7==s.length&&i.push([s[4],s[5],s[6]])),"vt"==s[0]&&a.push([s[1],s[2]]),"vn"==s[0]&&l.push([s[1],s[2],s[3]]),"f"==s[0]){let t=[];for(let e=1;e<s.length;e++)""!=s[e]&&(s[e]in p||(p[s[e]]=u++),t.push(p[s[e]]));r.push(t)}}if(this.obj_v=[],i.length>0&&(this.obj_c=[]),this.obj_i=r,l.length>0&&(this.obj_n=[]),a.length>0&&(this.obj_t=[]),r.length>0)for(let t in p){let e=t.split("/"),s=p[t];this.obj_v[s]=n[e[0]-1],i.length>0&&(this.obj_c[s]=i[e[0]-1]),a.length>0&&(this.obj_t[s]=a[e[1]-1]),l.length>0&&(this.obj_n[s]=l[e[2]-1])}else this.obj_v=n,i.length>0&&(this.obj_c=i),l.length>0&&(this.obj_n=l);console.log("loadobj "+t+" vtx:"+n.length+" norm:"+l.length+" tex:"+a.length+" idx:"+r.length+" vbuf:"+this.obj_v.length),s(this)}).catch(function(t){h(t)})})}static async loadObj2(t,e){let h=1,o=!1,n=!1,l=!1;return e&&(e.scale&&(h=e.scale),e.zup&&(o=e.zup),e.nogroup&&(n=e.nogroup),e.nomtl&&(l=e.nomtl)),new Promise((e,r)=>{const a=[],i=[],p={},u=[],c=[],f={},b=[];let v=0,d="",g="";const j=[],_=[];s.loadLines(t,async e=>{if(e.match(/^#/))return;if(e.match(/^eof/))return;const r=e.split(/\s+/),m=r[0];if("v"==m&&(o?a.push([r[1]*h,r[3]*h,-r[2]*h]):a.push([r[1]*h,r[2]*h,r[3]*h]),7==r.length&&c.push([r[4],r[5],r[6]])),"vt"==m&&u.push([r[1],r[2]]),"vn"==m&&(o?i.push([r[1],r[3],-r[2]]):i.push([r[1],r[2],r[3]])),"f"==m){let t=[];for(let e=1;e<r.length;e++)""!=r[e]&&(r[e]in f||(f[r[e]]=v++,b[f[r[e]]]=r[e]),t.push(f[r[e]]));p[g]||(p[g]={}),p[g][d]||(p[g][d]=[]),p[g][d].push(t)}if("mtllib"==m){if(t.constructor==File||Array.isArray(t))return void _.push(r.splice(1).join(" ").trim());let e=t.split("/");e[e.length-1]=r[1],j.push(s.loadMtl(e.join("/"))),_.push(e)}"usemtl"==m&&(l||(d=r[1])),"g"==m&&(n||(g=r[1]))}).then(h=>{const o=[];let l;for(let e in p){l=[];for(let h in p[e]){let o=p[e][h];const n=new s;if(n.obj_v=[],c.length>0&&(n.obj_c=[]),i.length>0&&(n.obj_n=[]),u.length>0&&(n.obj_t=[]),n.obj_i=o,o.length>0)for(let t in f){let e=t.split("/"),s=f[t];n.obj_v[s]=a[e[0]-1],c.length>0&&(n.obj_c[s]=c[e[0]-1]),u.length>0&&(n.obj_t[s]=u[e[1]-1]),i.length>0&&(n.obj_n[s]=i[e[2]-1])}else n.obj_v=a,c.length>0&&(n.obj_c=c),i.length>0&&(n.obj_n=i);l.push({obj:n,mtlname:h}),"string"!=typeof t&&(t=""),console.log("loadobj "+t+" vtx:"+a.length+" norm:"+i.length+" tex:"+u.length+" idx:"+o.length+" vbuf:"+n.obj_v.length)}o.push({objs:l,group:e})}j.length>0?Promise.all(j).then(t=>{let s={};for(let e in t)s=Object.assign(s,t[e]);e(n?{objs:l,mtls:s}:{groups:o,mtls:s})}):e(n?{objs:l,mtlpaths:_}:{groups:o,mtlpaths:_})}).catch(t=>{r(t)})})}static async loadMtl(t){const e=[];let h="";return new Promise((o,n)=>{s.loadLines(t,t=>{if(t.match(/^#/))return;if(t.match(/^eof/))return;let s=t.split(/\s+/),o=s.shift();if(""==o&&(o=s.shift()),"newmtl"==o)return h=s[0],void(e[h]={});switch(o){case"Kd":case"Ks":case"Ka":case"Tf":e[h][o]=[parseFloat(s[0]),parseFloat(s[1]),parseFloat(s[2])];break;case"Ni":case"d":case"Ns":case"Tr":e[h][o]=parseFloat(s[0]);break;case"illum":e[h][o]=parseInt(s[0]);break;case"map_Kd":case"map_Ka":case"map_Ks":e[h][o]=s.join(" ").trim()}}).then(t=>{o(e)}).catch(t=>{n(t)})})}static HSV2RGB(t,e,s,h){let o,n,l,r,a,i,p;switch(n=(t*=6)-(o=Math.floor(t)),1&o||(n=1-n),l=s*(1-e),r=s*(1-e*n),o){case 0:case 6:a=s,i=r,p=l;break;case 1:a=r,i=s,p=l;break;case 2:a=l,i=s,p=r;break;case 3:a=l,i=r,p=s;break;case 4:a=r,i=l,p=s;break;case 5:a=s,i=l,p=r}return[a,i,p,void 0===h?1:h]}static snormal(t){let e=t[1][0]-t[0][0],s=t[1][1]-t[0][1],h=t[1][2]-t[0][2],o=t[2][0]-t[0][0],n=t[2][1]-t[0][1],l=t[2][2]-t[0][2],r=s*l-h*n,a=-e*l+h*o,i=e*n-s*o,p=Math.hypot(r,a,i);return[r/=p,a/=p,i/=p]}}return t.WWModel=s});
//# sourceMappingURL=sourcemaps/WWModel.js.map

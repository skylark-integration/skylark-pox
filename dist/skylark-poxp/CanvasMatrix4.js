/**
 * skylark-poxp - A version of poxp that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-poxp/
 * @license MIT
 */
define(["./pox"],function(t){var i=function(t){if(void 0!=t&&"Float32Array"==t.name)return this.buf=t,this;if(this.buf=new Float32Array(16),this.matrix=null,"object"==typeof t){if("length"in t&&t.length>=16)return this.load(t),this;if(t instanceof i)return this.load(t),this}return this.makeIdentity(),this};return i.RAD=t.RAD,i.prototype.load=function(){if(1==arguments.length&&"object"==typeof arguments[0]){var t=arguments[0];if("length"in t&&16==t.length)return this.buf[0]=t[0],this.buf[1]=t[1],this.buf[2]=t[2],this.buf[3]=t[3],this.buf[4]=t[4],this.buf[5]=t[5],this.buf[6]=t[6],this.buf[7]=t[7],this.buf[8]=t[8],this.buf[9]=t[9],this.buf[10]=t[10],this.buf[11]=t[11],this.buf[12]=t[12],this.buf[13]=t[13],this.buf[14]=t[14],this.buf[15]=t[15],this;if(arguments[0]instanceof i)return this.buf[0]=t.buf[0],this.buf[1]=t.buf[1],this.buf[2]=t.buf[2],this.buf[3]=t.buf[3],this.buf[4]=t.buf[4],this.buf[5]=t.buf[5],this.buf[6]=t.buf[6],this.buf[7]=t.buf[7],this.buf[8]=t.buf[8],this.buf[9]=t.buf[9],this.buf[10]=t.buf[10],this.buf[11]=t.buf[11],this.buf[12]=t.buf[12],this.buf[13]=t.buf[13],this.buf[14]=t.buf[14],this.buf[15]=t.buf[15],this}return this.makeIdentity(),this},i.prototype.getAsArray=function(){return[this.buf[0],this.buf[1],this.buf[2],this.buf[3],this.buf[4],this.buf[5],this.buf[6],this.buf[7],this.buf[8],this.buf[9],this.buf[10],this.buf[11],this.buf[12],this.buf[13],this.buf[14],this.buf[15]]},i.prototype.getAsWebGLFloatArray=function(){return this.buf},i.prototype.initmatrix=function(){return this.matrix||(this.matrix=new i),this.matrix.makeIdentity(),this},i.prototype.makeIdentity=function(){return this.buf[0]=1,this.buf[1]=0,this.buf[2]=0,this.buf[3]=0,this.buf[4]=0,this.buf[5]=1,this.buf[6]=0,this.buf[7]=0,this.buf[8]=0,this.buf[9]=0,this.buf[10]=1,this.buf[11]=0,this.buf[12]=0,this.buf[13]=0,this.buf[14]=0,this.buf[15]=1,this},i.prototype.transpose=function(){var t=this.buf[1];return this.buf[1]=this.buf[4],this.buf[4]=t,t=this.buf[2],this.buf[2]=this.buf[8],this.buf[8]=t,t=this.buf[3],this.buf[3]=this.buf[12],this.buf[12]=t,t=this.buf[6],this.buf[6]=this.buf[9],this.buf[9]=t,t=this.buf[7],this.buf[7]=this.buf[13],this.buf[13]=t,t=this.buf[11],this.buf[11]=this.buf[14],this.buf[14]=t,this},i.prototype.invert=function(){var t=this._determinant4x4();return Math.abs(t)<1e-8?null:(this._makeAdjoint(),this.buf[0]/=t,this.buf[1]/=t,this.buf[2]/=t,this.buf[3]/=t,this.buf[4]/=t,this.buf[5]/=t,this.buf[6]/=t,this.buf[7]/=t,this.buf[8]/=t,this.buf[9]/=t,this.buf[10]/=t,this.buf[11]/=t,this.buf[12]/=t,this.buf[13]/=t,this.buf[14]/=t,this.buf[15]/=t,this)},i.prototype.translate=function(t,i,u){return(Array.isArray(t)||t instanceof Float32Array)&&(i=t[1],u=t[2],t=t[0]),void 0==t&&(t=0),void 0==i&&(i=0),void 0==u&&(u=0),this.buf[12]+=t,this.buf[13]+=i,this.buf[14]+=u,this},i.prototype.scale=function(t,i,u){return(Array.isArray(t)||t instanceof Float32Array)&&(i=t[1],u=t[2],t=t[0]),void 0==t&&(t=1),void 0==u?void 0==i?(i=t,u=t):u=1:void 0==i&&(i=t),this.buf[0]*=t,this.buf[1]*=t,this.buf[2]*=t,this.buf[4]*=i,this.buf[5]*=i,this.buf[6]*=i,this.buf[8]*=u,this.buf[9]*=u,this.buf[10]*=u,this},i.prototype.rotate=function(t,u,f,b){if(0==t)return this;(Array.isArray(u)||u instanceof Float32Array)&&(f=u[1],b=u[2],u=u[0]),t*=i.RAD,t/=2;var s=Math.sin(t),h=Math.cos(t),r=s*s;if(this.initmatrix(),1==u&&0==f&&0==b)this.matrix.buf[5]=1-2*r,this.matrix.buf[6]=2*s*h,this.matrix.buf[9]=-2*s*h,this.matrix.buf[10]=1-2*r;else if(0==u&&1==f&&0==b)this.matrix.buf[0]=1-2*r,this.matrix.buf[2]=-2*s*h,this.matrix.buf[8]=2*s*h,this.matrix.buf[10]=1-2*r;else if(0==u&&0==f&&1==b)this.matrix.buf[0]=1-2*r,this.matrix.buf[1]=2*s*h,this.matrix.buf[4]=-2*s*h,this.matrix.buf[5]=1-2*r;else{var n=Math.hypot(u,f,b);0==n?(u=0,f=0,b=1):1!=n&&(u/=n,f/=n,b/=n);var a=u*u,e=f*f,o=b*b;this.matrix.buf[0]=1-2*(e+o)*r,this.matrix.buf[1]=2*(u*f*r+b*s*h),this.matrix.buf[2]=2*(u*b*r-f*s*h),this.matrix.buf[4]=2*(f*u*r-b*s*h),this.matrix.buf[5]=1-2*(o+a)*r,this.matrix.buf[6]=2*(f*b*r+u*s*h),this.matrix.buf[8]=2*(b*u*r+f*s*h),this.matrix.buf[9]=2*(b*f*r-u*s*h),this.matrix.buf[10]=1-2*(a+e)*r}return this.multRight(this.matrix),this},i.prototype.multRight=function(t){var i=this.buf[0]*t.buf[0]+this.buf[1]*t.buf[4]+this.buf[2]*t.buf[8]+this.buf[3]*t.buf[12],u=this.buf[0]*t.buf[1]+this.buf[1]*t.buf[5]+this.buf[2]*t.buf[9]+this.buf[3]*t.buf[13],f=this.buf[0]*t.buf[2]+this.buf[1]*t.buf[6]+this.buf[2]*t.buf[10]+this.buf[3]*t.buf[14],b=this.buf[0]*t.buf[3]+this.buf[1]*t.buf[7]+this.buf[2]*t.buf[11]+this.buf[3]*t.buf[15],s=this.buf[4]*t.buf[0]+this.buf[5]*t.buf[4]+this.buf[6]*t.buf[8]+this.buf[7]*t.buf[12],h=this.buf[4]*t.buf[1]+this.buf[5]*t.buf[5]+this.buf[6]*t.buf[9]+this.buf[7]*t.buf[13],r=this.buf[4]*t.buf[2]+this.buf[5]*t.buf[6]+this.buf[6]*t.buf[10]+this.buf[7]*t.buf[14],n=this.buf[4]*t.buf[3]+this.buf[5]*t.buf[7]+this.buf[6]*t.buf[11]+this.buf[7]*t.buf[15],a=this.buf[8]*t.buf[0]+this.buf[9]*t.buf[4]+this.buf[10]*t.buf[8]+this.buf[11]*t.buf[12],e=this.buf[8]*t.buf[1]+this.buf[9]*t.buf[5]+this.buf[10]*t.buf[9]+this.buf[11]*t.buf[13],o=this.buf[8]*t.buf[2]+this.buf[9]*t.buf[6]+this.buf[10]*t.buf[10]+this.buf[11]*t.buf[14],x=this.buf[8]*t.buf[3]+this.buf[9]*t.buf[7]+this.buf[10]*t.buf[11]+this.buf[11]*t.buf[15],m=this.buf[12]*t.buf[0]+this.buf[13]*t.buf[4]+this.buf[14]*t.buf[8]+this.buf[15]*t.buf[12],y=this.buf[12]*t.buf[1]+this.buf[13]*t.buf[5]+this.buf[14]*t.buf[9]+this.buf[15]*t.buf[13],c=this.buf[12]*t.buf[2]+this.buf[13]*t.buf[6]+this.buf[14]*t.buf[10]+this.buf[15]*t.buf[14],p=this.buf[12]*t.buf[3]+this.buf[13]*t.buf[7]+this.buf[14]*t.buf[11]+this.buf[15]*t.buf[15];return this.buf[0]=i,this.buf[1]=u,this.buf[2]=f,this.buf[3]=b,this.buf[4]=s,this.buf[5]=h,this.buf[6]=r,this.buf[7]=n,this.buf[8]=a,this.buf[9]=e,this.buf[10]=o,this.buf[11]=x,this.buf[12]=m,this.buf[13]=y,this.buf[14]=c,this.buf[15]=p,this},i.prototype.multLeft=function(t){var i=t.buf[0]*this.buf[0]+t.buf[1]*this.buf[4]+t.buf[2]*this.buf[8]+t.buf[3]*this.buf[12],u=t.buf[0]*this.buf[1]+t.buf[1]*this.buf[5]+t.buf[2]*this.buf[9]+t.buf[3]*this.buf[13],f=t.buf[0]*this.buf[2]+t.buf[1]*this.buf[6]+t.buf[2]*this.buf[10]+t.buf[3]*this.buf[14],b=t.buf[0]*this.buf[3]+t.buf[1]*this.buf[7]+t.buf[2]*this.buf[11]+t.buf[3]*this.buf[15],s=t.buf[4]*this.buf[0]+t.buf[5]*this.buf[4]+t.buf[6]*this.buf[8]+t.buf[7]*this.buf[12],h=t.buf[4]*this.buf[1]+t.buf[5]*this.buf[5]+t.buf[6]*this.buf[9]+t.buf[7]*this.buf[13],r=t.buf[4]*this.buf[2]+t.buf[5]*this.buf[6]+t.buf[6]*this.buf[10]+t.buf[7]*this.buf[14],n=t.buf[4]*this.buf[3]+t.buf[5]*this.buf[7]+t.buf[6]*this.buf[11]+t.buf[7]*this.buf[15],a=t.buf[8]*this.buf[0]+t.buf[9]*this.buf[4]+t.buf[10]*this.buf[8]+t.buf[11]*this.buf[12],e=t.buf[8]*this.buf[1]+t.buf[9]*this.buf[5]+t.buf[10]*this.buf[9]+t.buf[11]*this.buf[13],o=t.buf[8]*this.buf[2]+t.buf[9]*this.buf[6]+t.buf[10]*this.buf[10]+t.buf[11]*this.buf[14],x=t.buf[8]*this.buf[3]+t.buf[9]*this.buf[7]+t.buf[10]*this.buf[11]+t.buf[11]*this.buf[15],m=t.buf[12]*this.buf[0]+t.buf[13]*this.buf[4]+t.buf[14]*this.buf[8]+t.buf[15]*this.buf[12],y=t.buf[12]*this.buf[1]+t.buf[13]*this.buf[5]+t.buf[14]*this.buf[9]+t.buf[15]*this.buf[13],c=t.buf[12]*this.buf[2]+t.buf[13]*this.buf[6]+t.buf[14]*this.buf[10]+t.buf[15]*this.buf[14],p=t.buf[12]*this.buf[3]+t.buf[13]*this.buf[7]+t.buf[14]*this.buf[11]+t.buf[15]*this.buf[15];return this.buf[0]=i,this.buf[1]=u,this.buf[2]=f,this.buf[3]=b,this.buf[4]=s,this.buf[5]=h,this.buf[6]=r,this.buf[7]=n,this.buf[8]=a,this.buf[9]=e,this.buf[10]=o,this.buf[11]=x,this.buf[12]=m,this.buf[13]=y,this.buf[14]=c,this.buf[15]=p,this},i.prototype.ortho=function(t,i,u,f,b,s){var h=(t+i)/(i-t),r=(f+u)/(f-u),n=(s+b)/(s-b);return this.initmatrix(),this.matrix.buf[0]=2/(i-t),this.matrix.buf[5]=2/(f-u),this.matrix.buf[10]=-2/(s-b),this.matrix.buf[12]=h,this.matrix.buf[13]=r,this.matrix.buf[14]=-n,this.multRight(this.matrix),this},i.prototype.frustum=function(t,i,u,f,b,s){this.initmatrix();var h=(i+t)/(i-t),r=(f+u)/(f-u),n=-(s+b)/(s-b),a=-2*s*b/(s-b);return this.matrix.buf[0]=2*b/(i-t),this.matrix.buf[5]=2*b/(f-u),this.matrix.buf[8]=h,this.matrix.buf[9]=r,this.matrix.buf[10]=n,this.matrix.buf[11]=-1,this.matrix.buf[14]=a,this.matrix.buf[15]=0,this.multRight(this.matrix),this},i.prototype.perspective=function(t,i,u,f){var b=Math.tan(t*Math.PI/360)*u,s=-b,h=i*s,r=i*b;return this.frustum(h,r,s,b,u,f),this},i.prototype.pallarel=function(t,i,u,f){var b=t/2,s=-b,h=b/i,r=-h;return this.ortho(s,b,r,h,u,f),this},i.prototype.lookat=function(t,i,u,f,b,s,h,r,n){this.initmatrix();var a=t-f,e=i-b,o=u-s,x=Math.hypot(a,e,o);return x&&(a/=x,e/=x,o/=x),xx=r*o-n*e,xy=-h*o+n*a,xz=h*e-r*a,yx=e*xz-o*xy,yy=-a*xz+o*xx,yz=a*xy-e*xx,(x=Math.hypot(xx,xy,xz))&&(xx/=x,xy/=x,xz/=x),(x=Math.hypot(yx,yy,yz))&&(yx/=x,yy/=x,yz/=x),this.matrix.buf[0]=xx,this.matrix.buf[1]=yx,this.matrix.buf[2]=a,this.matrix.buf[4]=xy,this.matrix.buf[5]=yy,this.matrix.buf[6]=e,this.matrix.buf[8]=xz,this.matrix.buf[9]=yz,this.matrix.buf[10]=o,this.matrix.buf[12]=-(xx*t+xy*i+xz*u),this.matrix.buf[13]=-(yx*t+yy*i+yz*u),this.matrix.buf[14]=-(a*t+e*i+o*u),this.multRight(this.matrix),this},i.prototype._determinant2x2=function(t,i,u,f){return t*f-i*u},i.prototype._determinant3x3=function(t,i,u,f,b,s,h,r,n){return t*this._determinant2x2(b,s,r,n)-f*this._determinant2x2(i,u,r,n)+h*this._determinant2x2(i,u,b,s)},i.prototype._determinant4x4=function(){var t=this.buf[0],i=this.buf[1],u=this.buf[2],f=this.buf[3],b=this.buf[4],s=this.buf[5],h=this.buf[6],r=this.buf[7],n=this.buf[8],a=this.buf[9],e=this.buf[10],o=this.buf[11],x=this.buf[12],m=this.buf[13],y=this.buf[14],c=this.buf[15];return t*this._determinant3x3(s,a,m,h,e,y,r,o,c)-i*this._determinant3x3(b,n,x,h,e,y,r,o,c)+u*this._determinant3x3(b,n,x,s,a,m,r,o,c)-f*this._determinant3x3(b,n,x,s,a,m,h,e,y)},i.prototype._makeAdjoint=function(){var t=this.buf[0],i=this.buf[1],u=this.buf[2],f=this.buf[3],b=this.buf[4],s=this.buf[5],h=this.buf[6],r=this.buf[7],n=this.buf[8],a=this.buf[9],e=this.buf[10],o=this.buf[11],x=this.buf[12],m=this.buf[13],y=this.buf[14],c=this.buf[15];this.buf[0]=this._determinant3x3(s,a,m,h,e,y,r,o,c),this.buf[4]=-this._determinant3x3(b,n,x,h,e,y,r,o,c),this.buf[8]=this._determinant3x3(b,n,x,s,a,m,r,o,c),this.buf[12]=-this._determinant3x3(b,n,x,s,a,m,h,e,y),this.buf[1]=-this._determinant3x3(i,a,m,u,e,y,f,o,c),this.buf[5]=this._determinant3x3(t,n,x,u,e,y,f,o,c),this.buf[9]=-this._determinant3x3(t,n,x,i,a,m,f,o,c),this.buf[13]=this._determinant3x3(t,n,x,i,a,m,u,e,y),this.buf[2]=this._determinant3x3(i,s,m,u,h,y,f,r,c),this.buf[6]=-this._determinant3x3(t,b,x,u,h,y,f,r,c),this.buf[10]=this._determinant3x3(t,b,x,i,s,m,f,r,c),this.buf[14]=-this._determinant3x3(t,b,x,i,s,m,u,h,y),this.buf[3]=-this._determinant3x3(i,s,a,u,h,e,f,r,o),this.buf[7]=this._determinant3x3(t,b,n,u,h,e,f,r,o),this.buf[11]=-this._determinant3x3(t,b,n,i,s,a,f,r,o),this.buf[15]=this._determinant3x3(t,b,n,i,s,a,u,h,e)},i.V3add=function(){let t=0,i=0,u=0;for(let f=0;f<arguments.length;f++)t+=arguments[f][0],i+=arguments[f][1],u+=arguments[f][2];return[t,i,u]},i.V3sub=function(){let t=arguments[0][0],i=arguments[0][1],u=arguments[0][2];for(let f=1;f<arguments.length;f++)t-=arguments[f][0],i-=arguments[f][1],u-=arguments[f][2];return[t,i,u]},i.V3inv=function(t){return[-t[0],-t[1],-t[2]]},i.V3len=function(t){return Math.hypot(t[0],t[1],t[2])},i.V3norm=function(t,u){const f=i.V3len(t);return void 0===u&&(u=1),0==f?[0,0,0]:[t[0]*u/f,t[1]*u/f,t[2]*u/f]},i.V3mult=function(t,i){return[t[0]*i,t[1]*i,t[2]*i]},i.V3dot=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},i.V3cross=function(t,i){return[t[1]*i[2]-t[2]*i[1],t[2]*i[0]-t[0]*i[2],t[0]*i[1]-t[1]*i[0]]},i.prototype.multVec4=function(t,i,u,f){return(Array.isArray(t)||t instanceof Float32Array)&&(i=t[1],u=t[2],f=t[3],t=t[0]),[this.buf[0]*t+this.buf[4]*i+this.buf[8]*u+this.buf[12]*f,this.buf[1]*t+this.buf[5]*i+this.buf[9]*u+this.buf[13]*f,this.buf[2]*t+this.buf[6]*i+this.buf[10]*u+this.buf[14]*f,this.buf[3]*t+this.buf[7]*i+this.buf[11]*u+this.buf[15]*f]},i.rotAndTrans=function(t,u,f,b,s,h){var r=new i;return 0!=t&&r.rotate(t,1,0,0),0!=u&&r.rotate(u,0,1,0),0!=f&&r.rotate(f,0,0,1),r.translate(b,s,h),r},i.prototype.q2m=function(t,i,u,f){(Array.isArray(t)||t instanceof Float32Array)&&(i=t[1],u=t[2],f=t[3],t=t[0]);var b=t*t,s=i*i,h=u*u;return this.buf[0]=1-2*(s+h),this.buf[1]=2*(t*i+f*u),this.buf[2]=2*(t*u-f*i),this.buf[3]=0,this.buf[4]=2*(t*i-f*u),this.buf[5]=1-2*(b+h),this.buf[6]=2*(i*u+f*t),this.buf[7]=0,this.buf[8]=2*(t*u+f*i),this.buf[9]=2*(i*u-f*t),this.buf[10]=1-2*(b+s),this.buf[11]=0,this.buf[12]=0,this.buf[13]=0,this.buf[14]=0,this.buf[15]=1,this},i.v2q=function(t,u,f,b){(Array.isArray(u)||u instanceof Float32Array)&&(f=u[1],b=u[2],u=u[0]);let s=u*u+f*f+b*b;if(0==s)return[0,0,0,1];1!=s&&(u/=s=Math.sqrt(s),f/=s,b/=s),t=t*i.RAD/2;let h=Math.sin(t);return[u*h,f*h,b*h,Math.cos(t)]},i.e2q=function(t,u,f){(Array.isArray(t)||t instanceof Float32Array)&&(u=t[1],f=t[2],t=t[0]),t*=.5*i.RAD,u*=.5*i.RAD,f*=.5*i.RAD;let b=Math.cos(t),s=Math.cos(u),h=Math.cos(f),r=Math.sin(t),n=Math.sin(u),a=Math.sin(f);return[r*s*h+b*n*a,b*n*h-r*s*a,b*s*a-r*n*h,b*s*h+r*n*a]},i.qMult=function(t,i){let u=t[3]*i[3]-(t[0]*i[0]+t[1]*i[1]+t[2]*i[2]);return[t[1]*i[2]-t[2]*i[1]+t[3]*i[0]+i[3]*t[0],t[2]*i[0]-t[0]*i[2]+t[3]*i[1]+i[3]*t[1],t[0]*i[1]-t[1]*i[0]+t[3]*i[2]+i[3]*t[2],u]},t.CanvasMatrix4=i});
//# sourceMappingURL=sourcemaps/CanvasMatrix4.js.map

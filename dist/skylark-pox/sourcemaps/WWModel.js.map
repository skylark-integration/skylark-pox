{"version":3,"sources":["WWModel.js"],"names":["define","pox","CanvasMatrix4","WWModel","[object Object]","type","param","wx","wy","wz","div","divx","divy","divz","ninv","p","n","t","s","PHI","Math","PI","m","r05","v","r04","r03","r02","r01","s11","s06","i","y","cos","r","sin","j","u","x","z","push","d2","base","pdiv","PH","yi","xr","xdiv","xi","li","xofs","xd","floor","pc","length","sc","dy","j2","cap","cubemap","this","parametricModel","px","py","pz","nx","ny","nz","mu","mv","start","end","sr","du","dv","cx","cz","vx","mx","mz","my","hypot","shape","vt","si","vi","vs","h","vl","vv","_uv","id","undefined","tridiv","atan2","acos","i1","i2","i3","v1","v2","v3","v12","V3norm","V3add","v23","v31","obj_v","obj_n","obj_t","obj_i","func","pu","pv","opt","pos","norm","uv","indices","iu","iv","dud","dvd","du0","du1","nux","nuy","nuz","dv0","dv1","nvx","nvy","nvz","nl","addvec","mode","c","obj_c","vbuf","ibuf","sf","sn","ii","l","pa","yx","yy","yz","zx","zy","zz","xx","xy","xz","vn","lj","console","log","parseFloat","av","concat","data","ret","vtx_at","vtx","idx","attr","vm","nv","k","ss","m4","inv","invert","transpose","buf","getAsArray","vy","vz","models","ofs","pp","sx","Number","MAX_VALUE","sy","sz","ex","MIN_VALUE","ey","ez","src","Promise","resolve","reject","req","XMLHttpRequest","open","responseType","onload","status","response","statusText","onerror","send","path","cb","lbufsize","decoder","TextDecoder","fetch","method","then","async","resp","ok","reader","body","getReader","Uint8Array","bi","done","value","read","decode","slice","char","scale","loadAjax","split","xic","len","match","ll","ix","ind","catch","err","zup","nogroup","nomtl","xl","rxi","usemtl","group","pmtls","mtlspath","loadLines","cmd","loadMtl","join","groups","objs","g","obj","mtlname","all","mtls","allmtls","Object","assign","parseInt","H","S","V","a","ih","fl","rr","gg","bb"],"mappings":"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WAAY,UAAW,YAAa,WAAY,UAAW,YAAa,WAAY,UAAW,WAAY,WAAY,UAAW,WAAY,WAAY,UAAW,aAAc,WAAY,SAAU,YAAa,WAAY,QAAS,aAAc,WAAY,UAAW,aAAc,UAAW,UAAW,YAAa,UAAW,UAAW,YAAa,UAAW,UAAW,YAAa,WAAY,UAAW,aAAc,WAAY,UAAW,aAAc,WAAY,UAAW,aAAc,WAAY,UAAW,YAAa,UAAW,UAAW,aAAc,UAAW,UAAW,YAAa,SAAU,UAAW,YAAa,UAAW,UAAW,aAAc,UAAW,UAAW,aAAc,UAAW,UAAW,YAAa,UAAW,UAAW,YAAa,UAAW,UAAW,aAAc,UAAW,UAAW,aAAc,SAAU,UAAW,YAAa,UAAW,UAAW,YAAa,UAAW,UAAW,WAAY,UAAW,UAAW,WAAY,UAAW,UAAW,WAAY,UAAW,UAAW,YAAa,UAAW,UAAW,YAAa,UAAW,UAAW,WAAY,UAAW,SAAU,YAAa,UAAW,UAAW,YAAa,UAAW,UAAW,YAAa,WAAY,UAAW,WAAY,UAAW,UAAW,YAAa,WAAY,UAAW,YAAa,WAAY,UAAW,YAAa,UAAW,UAAW,YAAa,SAAU,UAAW,YAAa,SAAU,UAAW,WAAY,WAAY,UAAW,YAAa,WAAY,QAAS,YAAa,WAAY,SAAU,YAAa,WAAY,WAAY,aAAc,UAAW,WAAY,aAAc,WAAY,UAAW,aAAc,WAAY,WAAY,aAAc,UAAW,WAAY,aAAc,WAAY,WAAY,aAAc,WAAY,WAAY,aAAc,WAAY,WAAY,aAAc,WAAY,WAAY,aAAc,WAAY,WAAY,aAAc,WAAY,WAAY,aAAc,WAAY,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,WAAY,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,UAAW,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,aAAc,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,WAAY,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,WAAY,YAAa,UAAW,UAAW,YAAa,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","file":"../WWModel.js","sourcesContent":["define([\n    \"./pox\",\n    \"./CanvasMatrix4\"\n],function(pox,CanvasMatrix4){\n\t//Model library for WWG\n\t// Version 1.0 \n\t// 2016-2017 wakufactory.jp \n\t// license: MIT \n\n\t// export default \n\tclass WWModel {\n\n\t\t// generate primitive\n\t\t primitive(type,param) {\n\t\t\tif(!param) param = {} ;\n\t\t\tlet wx = (param.wx)?param.wx:1.0 ;\n\t\t\tlet wy = (param.wy)?param.wy:1.0 ;\n\t\t\tlet wz = (param.wz)?param.wz:1.0 ;\n\t\t\tlet div = (param.div)?param.div:10 ;\n\t\t\tlet divx = (param.divx)?param.divx:div ;\n\t\t\tlet divy = (param.divy)?param.divy:div ;\n\t\t\tlet divz = (param.divz)?param.divz:div ;\n\t\t\tlet ninv = (param.ninv)?-1:1 ;\n\t\t\tlet p = [] ;\n\t\t\tlet n = [] ;\n\t\t\tlet t = [] ;\n\t\t\tlet s = [] ;\n\t\t\tlet PHI = Math.PI *2 ;\n\t\t\t\tlet m = { \"r05\":{\"v\":[[-0.52573111,-0.7236068,0.4472136],[-0.85065081,0.2763932,0.4472136],[-0,0.89442719,0.4472136],[0.85065081,0.2763932,0.4472136],[0.52573111,-0.7236068,0.4472136],[0,-0.89442719,-0.4472136],[-0.85065081,-0.2763932,-0.4472136],[-0.52573111,0.7236068,-0.4472136],[0.52573111,0.7236068,-0.4472136],[0.85065081,-0.2763932,-0.4472136],[0,0,1],[-0,0,-1]],\"s\":[[0,1,6],[0,6,5],[0,5,4],[0,4,10],[0,10,1],[1,2,7],[1,7,6],[1,10,2],[2,3,8],[2,8,7],[2,10,3],[3,4,9],[3,9,8],[3,10,4],[4,5,9],[5,6,11],[5,11,9],[6,7,11],[7,8,11],[8,9,11]]},\n\t\t\t\t\"r04\":{\"v\":[[-0.35682209,-0.49112347,0.79465447],[0.35682209,-0.49112347,0.79465447],[0.57735027,-0.79465447,0.18759247],[0,-0.98224695,-0.18759247],[-0.57735027,-0.79465447,0.18759247],[-0.57735027,0.18759247,0.79465447],[0.57735027,0.18759247,0.79465447],[0.93417236,-0.303531,-0.18759247],[-0,-0.607062,-0.79465447],[-0.93417236,-0.303531,-0.18759247],[-0.93417236,0.303531,0.18759247],[0,0.607062,0.79465447],[0.93417236,0.303531,0.18759247],[0.57735027,-0.18759247,-0.79465447],[-0.57735027,-0.18759247,-0.79465447],[-0.57735027,0.79465447,-0.18759247],[0,0.98224695,0.18759247],[0.57735027,0.79465447,-0.18759247],[0.35682209,0.49112347,-0.79465447],[-0.35682209,0.49112347,-0.79465447]],\"s\":[[0,1,6,11,5],[0,5,10,9,4],[0,4,3,2,1],[1,2,7,12,6],[2,3,8,13,7],[3,4,9,14,8],[5,11,16,15,10],[6,12,17,16,11],[7,13,18,17,12],[8,14,19,18,13],[9,10,15,19,14],[15,16,17,18,19]]},\n\t\t\t\t\"r03\":{\"v\":[[-0.57735027,-0.57735027,0.57735027],[-0.57735027,0.57735027,0.57735027],[0.57735027,0.57735027,0.57735027],[0.57735027,-0.57735027,0.57735027],[-0.57735027,-0.57735027,-0.57735027],[-0.57735027,0.57735027,-0.57735027],[0.57735027,0.57735027,-0.57735027],[0.57735027,-0.57735027,-0.57735027]],\"s\":[[0,1,5,4],[0,4,7,3],[0,3,2,1],[1,2,6,5],[2,3,7,6],[4,5,6,7]]},\n\t\t\t\t\"r02\":{\"v\":[[-0.70710678,-0.70710678,0],[-0.70710678,0.70710678,0],[0.70710678,0.70710678,0],[0.70710678,-0.70710678,0],[0,0,-1],[0,0,1]],\"s\":[[0,1,4],[0,4,3],[0,3,5],[0,5,1],[1,2,4],[1,5,2],[2,3,4],[2,5,3]]},\n\t\t\t\t\"r01\":{\"v\":[[-0.81649658,-0.47140452,0.33333333],[0.81649658,-0.47140452,0.33333333],[0,0,-1],[0,0.94280904,0.33333333]],\"s\":[[0,1,3],[0,3,2],[0,2,1],[1,2,3]]},\n\t\t\t\t\"s11\":{\"v\":[[-0.13149606,-0.40470333,0.90494412],[-0.34426119,-0.25012042,0.90494412],[-0.42553024,-1.0e-8,0.90494412],[-0.34426119,0.2501204,0.90494412],[-0.13149606,0.40470332,0.90494412],[0.13149611,0.40470332,0.90494412],[0.34426124,0.2501204,0.90494412],[0.42553028,-1.0e-8,0.90494412],[0.34426124,-0.25012042,0.90494412],[0.13149611,-0.40470333,0.90494412],[-0.13149606,-0.62841783,0.76668096],[-0.34426119,-0.69754941,0.6284178],[-0.42553024,-0.80940666,0.4047033],[-0.34426119,-0.92126391,0.18098881],[-0.13149606,-0.99039549,0.04272564],[0.13149611,-0.99039549,0.04272564],[0.34426124,-0.92126391,0.18098881],[0.42553028,-0.80940666,0.4047033],[0.34426124,-0.69754941,0.6284178],[0.13149611,-0.62841783,0.76668096],[-0.55702632,-0.5429665,0.6284178],[-0.55702632,-0.319252,0.76668096],[-0.63829537,-0.06913159,0.76668096],[-0.76979145,0.11185724,0.6284178],[-0.90128753,0.15458291,0.4047033],[-0.98255658,0.04272566,0.1809888],[-0.98255658,-0.18098884,0.04272564],[-0.90128753,-0.43110925,0.04272564],[-0.76979145,-0.61209808,0.18098881],[-0.63829537,-0.65482375,0.4047033],[-0.82001848,0.54296648,0.18098881],[-0.82001848,0.40470332,0.4047033],[-0.6885224,0.36197765,0.6284178],[-0.47575727,0.43110923,0.76668096],[-0.26299214,0.58569215,0.76668096],[-0.13149606,0.76668098,0.6284178],[-0.13149606,0.90494414,0.4047033],[-0.26299214,0.94766981,0.18098881],[-0.47575727,0.87853823,0.04272564],[-0.6885224,0.72395531,0.04272564],[0.47575732,0.87853821,0.04272564],[0.26299219,0.94766979,0.1809888],[0.13149611,0.90494413,0.4047033],[0.13149611,0.76668098,0.6284178],[0.26299219,0.58569215,0.76668096],[0.47575732,0.43110923,0.76668096],[0.68852245,0.36197765,0.6284178],[0.82001853,0.4047033,0.40470331],[0.82001853,0.54296646,0.18098881],[0.68852245,0.72395529,0.04272564],[0.63829541,-0.65482375,0.4047033],[0.7697915,-0.61209808,0.18098881],[0.90128758,-0.43110925,0.04272564],[0.98255663,-0.18098884,0.04272564],[0.98255647,0.04272561,0.18098879],[0.9012875,0.15458288,0.40470331],[0.7697915,0.11185724,0.6284178],[0.63829541,-0.06913159,0.76668096],[0.55702637,-0.319252,0.76668096],[0.55702637,-0.5429665,0.6284178],[-0.47575727,-0.87853824,-0.04272569],[-0.6885224,-0.72395533,-0.04272569],[-0.82001848,-0.5429665,-0.18098886],[-0.82001848,-0.40470333,-0.40470335],[-0.6885224,-0.36197767,-0.62841785],[-0.47575727,-0.43110925,-0.76668101],[-0.26299214,-0.58569216,-0.76668101],[-0.13149605,-0.76668099,-0.62841784],[-0.13149606,-0.90494416,-0.40470335],[-0.26299214,-0.94766982,-0.18098885],[-0.90128753,-0.15458292,-0.40470335],[-0.98255658,-0.04272567,-0.18098885],[-0.98255658,0.18098882,-0.04272569],[-0.90128753,0.43110923,-0.04272569],[-0.76979145,0.61209806,-0.18098885],[-0.63829536,0.65482373,-0.40470335],[-0.55702632,0.54296648,-0.62841785],[-0.55702632,0.31925199,-0.76668101],[-0.63829537,0.06913157,-0.76668101],[-0.76979145,-0.11185726,-0.62841785],[-0.13149606,0.62841781,-0.76668101],[-0.34426119,0.6975494,-0.62841785],[-0.42553023,0.80940665,-0.40470335],[-0.34426119,0.92126389,-0.18098885],[-0.13149606,0.99039547,-0.04272569],[0.13149611,0.99039546,-0.04272569],[0.34426124,0.92126387,-0.18098886],[0.42553028,0.80940661,-0.40470335],[0.34426124,0.69754939,-0.62841785],[0.13149611,0.62841781,-0.76668101],[0.76979153,-0.11185725,-0.62841782],[0.63829541,0.06913155,-0.76668097],[0.55702634,0.31925197,-0.76668097],[0.55702635,0.54296649,-0.62841782],[0.63829541,0.6548237,-0.40470335],[0.76979149,0.61209803,-0.18098885],[0.9012875,0.43110919,-0.04272571],[0.98255648,0.18098877,-0.04272572],[0.9825564,-0.04272561,-0.18098874],[0.90128711,-0.15458281,-0.4047032],[0.26299219,-0.94766982,-0.18098885],[0.13149611,-0.90494416,-0.40470335],[0.13149611,-0.76668098,-0.62841784],[0.26299219,-0.58569215,-0.76668099],[0.47575682,-0.43110886,-0.76668009],[0.68852237,-0.36197738,-0.6284173],[0.82001805,-0.40470325,-0.40470322],[0.82001853,-0.5429665,-0.18098885],[0.68852245,-0.72395533,-0.04272569],[0.47575732,-0.87853824,-0.04272569],[-0.13149606,-0.40470333,-0.90494417],[-0.34426119,-0.25012042,-0.90494417],[-0.42553024,-0,-0.90494417],[-0.34426119,0.2501204,-0.90494417],[-0.13149606,0.40470332,-0.90494417],[0.13149611,0.40470332,-0.90494417],[0.3442612,0.25012038,-0.90494414],[0.42553027,-3.0e-8,-0.90494414],[0.3442606,-0.25012001,-0.90494332],[0.13149611,-0.40470332,-0.90494416]],\"s\":[[0,1,21,20,11,10],[0,10,19,9],[0,9,8,7,6,5,4,3,2,1],[1,2,22,21],[2,3,33,32,23,22],[3,4,34,33],[4,5,44,43,35,34],[5,6,45,44],[6,7,57,56,46,45],[7,8,58,57],[8,9,19,18,59,58],[10,11,12,13,14,15,16,17,18,19],[11,20,29,12],[12,29,28,61,60,13],[13,60,69,14],[14,69,68,101,100,15],[15,100,109,16],[16,109,108,51,50,17],[17,50,59,18],[20,21,22,23,24,25,26,27,28,29],[23,32,31,24],[24,31,30,73,72,25],[25,72,71,26],[26,71,70,63,62,27],[27,62,61,28],[30,31,32,33,34,35,36,37,38,39],[30,39,74,73],[35,43,42,36],[36,42,41,85,84,37],[37,84,83,38],[38,83,82,75,74,39],[40,41,42,43,44,45,46,47,48,49],[40,49,95,94,87,86],[40,86,85,41],[46,56,55,47],[47,55,54,97,96,48],[48,96,95,49],[50,51,52,53,54,55,56,57,58,59],[51,108,107,52],[52,107,106,99,98,53],[53,98,97,54],[60,61,62,63,64,65,66,67,68,69],[63,70,79,64],[64,79,78,112,111,65],[65,111,110,66],[66,110,119,103,102,67],[67,102,101,68],[70,71,72,73,74,75,76,77,78,79],[75,82,81,76],[76,81,80,114,113,77],[77,113,112,78],[80,81,82,83,84,85,86,87,88,89],[80,89,115,114],[87,94,93,88],[88,93,92,116,115,89],[90,91,92,93,94,95,96,97,98,99],[90,99,106,105],[90,105,104,118,117,91],[91,117,116,92],[100,101,102,103,104,105,106,107,108,109],[103,119,118,104],[110,111,112,113,114,115,116,117,118,119]]},\n\t\t\t\t\"s06\":{\"v\":[[-0.20177411,-0.27771823,0.93923362],[-0.40354821,-0.55543646,0.72707577],[-0.20177411,-0.8331547,0.51491792],[0.20177411,-0.8331547,0.51491792],[0.40354821,-0.55543646,0.72707577],[0.20177411,-0.27771823,0.93923362],[-0.32647736,0.10607893,0.93923362],[-0.65295472,0.21215785,0.72707577],[-0.85472883,-0.06556038,0.51491792],[-0.73002557,-0.44935754,0.51491792],[-0.73002557,-0.66151539,0.17163931],[-0.40354821,-0.89871508,0.17163931],[-0.20177411,-0.96427546,-0.17163931],[0.20177411,-0.96427546,-0.17163931],[0.40354821,-0.89871508,0.17163931],[0.73002557,-0.66151539,0.17163931],[0.73002557,-0.44935754,0.51491792],[0.85472883,-0.06556038,0.51491792],[0.65295472,0.21215785,0.72707577],[0.32647736,0.10607893,0.93923362],[-0,0.34327861,0.93923362],[-0.65295472,0.55543646,0.51491792],[-0.85472883,0.48987608,0.17163931],[-0.97943209,0.10607893,0.17163931],[-0.97943209,-0.10607892,-0.17163931],[-0.85472883,-0.48987608,-0.17163931],[-0.65295472,-0.55543646,-0.51491792],[-0.32647736,-0.79263615,-0.51491792],[-0,-0.68655723,-0.72707577],[0.32647736,-0.79263615,-0.51491792],[0.65295472,-0.55543646,-0.51491792],[0.85472883,-0.48987608,-0.17163931],[0.97943209,-0.10607893,-0.17163931],[0.97943209,0.10607893,0.17163931],[0.85472883,0.48987608,0.17163931],[0.65295472,0.55543646,0.51491792],[0.32647736,0.79263615,0.51491792],[0,0.68655723,0.72707577],[-0.32647736,0.79263615,0.51491792],[-0.73002557,0.66151539,-0.17163931],[-0.73002557,0.44935754,-0.51491792],[-0.85472883,0.06556038,-0.51491792],[-0.65295472,-0.21215785,-0.72707577],[-0.32647736,-0.10607892,-0.93923362],[0,-0.34327861,-0.93923362],[0.32647736,-0.10607892,-0.93923362],[0.65295472,-0.21215785,-0.72707577],[0.85472883,0.06556038,-0.51491792],[0.73002557,0.44935754,-0.51491792],[0.73002557,0.66151539,-0.17163931],[0.40354821,0.89871508,-0.17163931],[0.20177411,0.96427546,0.17163931],[-0.20177411,0.96427546,0.17163931],[-0.40354821,0.89871508,-0.17163931],[-0.20177411,0.83315469,-0.51491792],[-0.40354821,0.55543646,-0.72707577],[-0.20177411,0.27771823,-0.93923362],[0.2017741,0.27771823,-0.93923362],[0.40354821,0.55543646,-0.72707577],[0.20177411,0.83315469,-0.51491792]],\"s\":[[0,5,19,20,6],[0,6,7,8,9,1],[0,1,2,3,4,5],[1,9,10,11,2],[2,11,12,13,14,3],[3,14,15,16,4],[4,16,17,18,19,5],[6,20,37,38,21,7],[7,21,22,23,8],[8,23,24,25,10,9],[10,25,26,27,12,11],[12,27,28,29,13],[13,29,30,31,15,14],[15,31,32,33,17,16],[17,33,34,35,18],[18,35,36,37,20,19],[21,38,52,53,39,22],[22,39,40,41,24,23],[24,41,42,26,25],[26,42,43,44,28,27],[28,44,45,46,30,29],[30,46,47,32,31],[32,47,48,49,34,33],[34,49,50,51,36,35],[36,51,52,38,37],[39,53,54,55,40],[40,55,56,43,42,41],[43,56,57,45,44],[45,57,58,48,47,46],[48,58,59,50,49],[50,59,54,53,52,51],[54,59,58,57,56,55]]}\n\t\t\t\t} ;\n\t\t\tswitch(type) {\n\t\t\tcase \"sphere\":\n\t\t\t\tfor(let i = 0 ; i <= div ; ++i) {\n\t\t\t\t\tlet v = i / (0.0+div);\n\t\t\t\t\tlet y = Math.cos(Math.PI * v), r = Math.sin(Math.PI * v);\n\t\t\t\t\tfor(let j = 0 ; j <= div*2 ; ++j) {\n\t\t\t\t\t\tlet u = j / (0+div*2) ;\n\t\t\t\t\t\tlet x = (Math.cos(PHI * u) * r)\n\t\t\t\t\t\tlet z = (Math.sin(PHI * u) * r)\n\t\t\t\t\t\tp.push([x*wx,y*wy,z*wz])\n\t\t\t\t\t\tn.push([x*ninv,y*ninv,z*ninv])\n\t\t\t\t\t\tt.push([(ninv>0)?1-u:u,1-v])\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet d2 = div*2+1 ;\n\t\t\t\tfor(let j = 0 ; j < div ; ++j) {\n\t\t\t\t\tlet base = j * d2;\n\t\t\t\t\tfor(let i = 0 ; i < div*2 ; ++i) {\n\t\t\t\t\t\tif(ninv>0) s.push(\n\t\t\t\t\t\t\t[base + i,\t  base + i + 1, base + i     + d2],\n\t\t\t\t\t\t\t[base + i + d2, base + i + 1, base + i + 1 + d2]);\n\t\t\t\t\t\telse s.push(\n\t\t\t\t\t\t\t[base + i     + d2,\tbase + i + 1, base + i],\n\t\t\t\t\t\t\t[base + i + 1 + d2, base + i + 1, base + i + d2 ]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\tcase \"sphere2\":\n\t\t\t\tconst pdiv = (param.div)?param.div:6 \n\t\t\t\tconst PH = Math.PI/2\n\t\t\t\tfor(let yi=0; yi<pdiv;yi++) {\n\t\t\t\t\tlet y = Math.sin(PH*yi/pdiv)\n\t\t\t\t\tlet xr = Math.cos(PH*yi/pdiv)\n\t\t\t\t\tlet xdiv = pdiv-yi\n\t\t\t\t\tfor(let xi=0;xi<=xdiv;xi++) {\n\t\t\t\t\t\tlet x = Math.cos(PH*xi/xdiv)*xr\n\t\t\t\t\t\tlet z = Math.sin(PH*xi/xdiv)*xr\n\t\t\t\t\t\tp.push([x*wx,y*wy,z*wz])\n\t\t\t\t\t\tn.push([x,y,z])\n\t\t\t\t\t\tt.push([1-xi/xdiv/4,0.5+yi/pdiv/2])\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.push([0,wy,0])\n\t\t\t\tn.push([0,1,0])\n\t\t\t\tt.push([0.75,1])\n\t\t\t\tlet li = 0\n\t\t\t\tfor(let yi=0;yi<pdiv;yi++) {\n\t\t\t\t\tlet xdiv = (pdiv-yi)*2-1\n\t\t\t\t\tlet xofs = pdiv-yi+1\n\t\t\t\t\tfor(let xi=0;xi<xdiv;xi++) {\n\t\t\t\t\t\tlet xd = Math.floor(xi/2)\n\t\t\t\t\t\tif(xi%2==0) {\n\t\t\t\t\t\t\tif(ninv>0) s.push([xd+li,xd+li+xofs,xd+li+1])\n\t\t\t\t\t\t\telse  s.push([xd+li,xd+li+1,xd+li+xofs])\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(ninv>0) s.push([xd+1+li,xd+li+xofs,xd+li+xofs+1])\n\t\t\t\t\t\t\telse  s.push([xd+1+li,xd+li+xofs+1,xd+li+xofs])\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tli += xofs\n\t\t\t\t}\n\t\t\t\tlet pc = p.length \n\t\t\t\tlet sc = s.length\n\t\t\t\tfor(let i=0;i<pc;i++) {\n\t\t\t\t\tp.push([p[i][0],-p[i][1],p[i][2]])\n\t\t\t\t\tn.push([p[i][0],-p[i][1],p[i][2]])\n\t\t\t\t\tt.push([t[i][0],1-t[i][1]])\n\t\t\t\t}\n\t\t\t\tfor(let i=0;i<sc;i++) {\n\t\t\t\t\ts.push([s[i][0]+pc,s[i][2]+pc,s[i][1]+pc])\n\t\t\t\t}\n\t\t\t\tpc = p.length \n\t\t\t\tsc = s.length\n\t\t\t\tfor(let i=0;i<pc;i++) {\n\t\t\t\t\tp.push([-p[i][0],p[i][1],p[i][2]])\n\t\t\t\t\tn.push([-p[i][0],p[i][1],p[i][2]])\n\t\t\t\t\tt.push([1-t[i][0]+0.5,t[i][1]])\n\t\t\t\t}\n\t\t\t\tfor(let i=0;i<sc;i++) {\n\t\t\t\t\ts.push([s[i][0]+pc,s[i][2]+pc,s[i][1]+pc])\n\t\t\t\t}\n\t\t\t\tpc = p.length \n\t\t\t\tsc = s.length\n\t\t\t\tfor(let i=0;i<pc;i++) {\n\t\t\t\t\tp.push([p[i][0],p[i][1],-p[i][2]])\n\t\t\t\t\tn.push([p[i][0],p[i][1],-p[i][2]])\n\t\t\t\t\tt.push([1-t[i][0],t[i][1]])\n\t\t\t\t}\n\t\t\t\tfor(let i=0;i<sc;i++) {\n\t\t\t\t\ts.push([s[i][0]+pc,s[i][2]+pc,s[i][1]+pc])\n\t\t\t\t}\t\n\t\t\t\tbreak ;\n\t\t\tcase \"cylinder\":\n\t\t\t\tdivy = (param.divy)?param.divy:1\n\t\t\t\tfor(let i = 0 ; i <= div ; ++i) {\n\t\t\t\t\tlet v = i / (0.0+div);\n\t\t\t\t\tlet z = Math.sin(PHI * v)*wz, x = Math.cos(PHI * v)*wx;\n\t\t\t\t\tlet dy = wy*2/divy ;\n\t\t\t\t\tfor(let yi=0;yi<=divy;yi++) {\n\t\t\t\t\t\tp.push([x,yi*dy-wy,z])\n\t\t\t\t\t\tn.push([x*ninv,0,z*ninv])\n\t\t\t\t\t\tt.push([(ninv>0)?1-v:v,yi/divy])\n\t\t//\t\t\t\tp.push([x,(yi+1)*dy-wy,z])\n\t\t//\t\t\t\tn.push([x*ninv,0,z*ninv,0])\n\t\t//\t\t\t\tt.push([(ninv>0)?1-v:v,0])\n\t\t\t\t\t}\t\t\t\n\t\t\t\t}\n\t\t\t\tfor(let j =0; j < div ;j++) {\n\t\t\t\t\tfor(let yi=0;yi<divy;yi++) {\n\t\t\t\t\t\tlet j2 = j*(divy+1)+yi \n\t\t\t\t\t\tif(ninv<0)s.push([j2,j2+(divy+1),j2+(divy+1)+1,j2+1]) ;\n\t\t\t\t\t\telse s.push([j2,j2+1,j2+3,j2+2]) ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(param.cap) {\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tbreak; \n\t\t\tcase \"ring\":\n\t\t\t\tdivy = (param.divy)?param.divy:1\n\t\t\t\tfor(let i = 0 ; i <= div ; ++i) {\n\t\t\t\t\tlet v = i / (0.0+div);\n\t\t\t\t\tlet z = Math.sin(PHI * v)*wz, x = Math.cos(PHI * v)*wx;\n\t\t\t\t\tfor(let yi=0;yi<divy;yi++) {\n\t\t\t\t\t\tp.push([x,wy,z])\n\t\t\t\t\t\tn.push([x*ninv,0,z*ninv])\n\t\t\t\t\t\tt.push([(ninv>0)?1-v:v,1])\n\t\t\t\t\t\tp.push([x,-wy,z])\n\t\t\t\t\t\tn.push([x*ninv,0,z*ninv,0])\n\t\t\t\t\t\tt.push([(ninv>0)?1-v:v,0])\n\t\t\t\t\t}\t\t\t\n\t\t\t\t}\n\t\t\t\tfor(let j =0; j < div ;j++) {\n\t\t\t\t\tif(ninv>0)s.push([j*2,j*2+2,j*2+3,j*2+1]) ;\n\t\t\t\t\telse s.push([j*2,j*2+1,j*2+3,j*2+2]) ;\n\t\t\t\t}\n\t\t\t\tif(param.cap) {\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tbreak; \n\t\t\tcase \"cone\":\n\t\t\t\tfor(let i = 0 ; i <= div ; ++i) {\n\t\t\t\t\tlet v = i / (0.0+div);\n\t\t\t\t\tlet z = Math.sin(PHI * v)*wz, x = Math.cos(PHI * v)*wx;\n\t\t\t\t\tp.push([0,wy,0])\n\t\t\t\t\tn.push([x*ninv,0,z*ninv])\n\t\t\t\t\tt.push([(ninv>0)?1-v:v,1])\n\t\t\t\t\tp.push([x,-wy,z])\n\t\t\t\t\tn.push([x*ninv,0,z*ninv,0])\n\t\t\t\t\tt.push([(ninv>0)?1-v:v,0])\t\t\t\n\t\t\t\t}\n\t\t\t\tfor(let j =0; j < div ;j++) {\n\t\t\t\t\tif(ninv>0)s.push([j*2,j*2+2,j*2+3,j*2+1]) ;\n\t\t\t\t\telse s.push([j*2,j*2+1,j*2+3,j*2+2]) ;\n\t\t\t\t}\n\t\t\t\tbreak; \n\t\t\tcase \"disc\":\n\t\t\t\tfor(let i = 0 ; i < div ; ++i) {\n\t\t\t\t\tlet v = i / (0.0+div);\n\t\t\t\t\tlet z = Math.cos(PHI * v)*wz, x = Math.sin(PHI * v)*wx;\n\t\t\t\t\tp.push([x,0,z])\n\t\t\t\t\tn.push([0,1,0])\n\t\t\t\t\tt.push([(x/wx+1)/2,(z/wz+1)/2])\t\n\t\t\t\t}\n\t\t\t\tp.push([0,0,0])\n\t\t\t\tn.push([0,1,0])\n\t\t\t\tt.push([0.5,0.5])\n\t\t\t\tfor(let j =0; j < div-1 ;j++) {\n\t\t\t\t\ts.push([j,j+1,div]) ;\n\t\t\t\t}\n\t\t\t\ts.push([div-1,0,div])\n\t\t\t\tbreak; \n\t\t\tcase \"plane\":\n\t\t\t\tif(!param.wz)  {\n\t\t\t\t\tp = [[wx,-wy,0],[wx,wy,0],[-wx,wy,0],[-wx,-wy,0]]\n\t\t\t\t\tn = [[0,0,ninv],[0,0,ninv],[0,0,ninv],[0,0,ninv]]\n\t\t\t\t} else if(!param.wx){\n\t\t\t\t\tp = [[0,-wy,-wz],[0,wy,-wz],[0,wy,wz],[0,-wy,wz]]\n\t\t\t\t\tn = [[ninv,0,0],[ninv,0,0],[ninv,0,0],[ninv,0,0]]\n\t\t\t\t}else {\n\t\t\t\t\tp = [[wx,0,wz],[wx,0,-wz],[-wx,0,-wz],[-wx,0,wz]]\n\t\t\t\t\tn = [[0,ninv,0],[0,ninv,0],[0,ninv,0],[0,ninv,0]]\n\t\t\t\t}\n\t\t\t\tt = (ninv>0)?[[1,0],[1,1],[0,1],[0,0]]:[[-1,0],[-1,1],[0,1],[0,0]]\n\t\t\t\ts = (ninv>0)?[[0,1,2],[2,3,0]]:[[2,1,0],[0,3,2]]\n\t\t\t\tbreak ;\n\t\t\tcase \"box\":\n\t\t\t\tp = [\n\t\t\t\t\t[wx,wy,wz],[wx,-wy,wz],[-wx,-wy,wz],[-wx,wy,wz],\t\t//+z\n\t\t\t\t\t[wx,wy,-wz],[wx,-wy,-wz],[-wx,-wy,-wz],[-wx,wy,-wz],//-z\n\t\t\t\t\t[wx,wy,wz],[wx,-wy,wz],[wx,-wy,-wz],[wx,wy,-wz],\t\t//+x\n\t\t\t\t\t[-wx,wy,wz],[-wx,-wy,wz],[-wx,-wy,-wz],[-wx,wy,-wz],//-x\n\t\t\t\t\t[wx,wy,wz],[wx,wy,-wz],[-wx,wy,-wz],[-wx,wy,wz],\t\t//+y\n\t\t\t\t\t[wx,-wy,wz],[wx,-wy,-wz],[-wx,-wy,-wz],[-wx,-wy,wz],\t//-y\n\t\t\t\t]\n\t\t\t\tn = [\n\t\t\t\t\t[0,0,ninv],[0,0,ninv],[0,0,ninv],[0,0,ninv],\n\t\t\t\t\t[0,0,-ninv],[0,0,-ninv],[0,0,-ninv],[0,0,-ninv],\n\t\t\t\t\t[ninv,0,0],[ninv,0,0],[ninv,0,0],[ninv,0,0],\n\t\t\t\t\t[-ninv,0,0],[-ninv,0,0],[-ninv,0,0],[-ninv,0,0],\n\t\t\t\t\t[0,ninv,0],[0,ninv,0],[0,ninv,0],[0,ninv,0],\n\t\t\t\t\t[0,-ninv,0],[0,-ninv,0],[0,-ninv,0],[0,-ninv,0]\n\t\t\t\t]\n\t\t\t\tt = (param.cubemap==1)?[\n\t\t\t\t\t[3/4,2/3],[3/4,1/3],[1,1/3],[1,2/3],\n\t\t\t\t\t[1/2,2/3],[1/2,1/3],[1/4,1/3],[1/4,2/3],\n\t\t\t\t\t[3/4,2/3],[3/4,1/3],[1/2,1/3],[1/2,2/3],\n\t\t\t\t\t[0,2/3],[0,1/3],[1/4,1/3],[1/4,2/3],\n\t\t\t\t\t[1/2,1],[1/2,2/3],[1/4,2/3],[1/4,1],\n\t\t\t\t\t[1/2,0],[1/2,1/3],[1/4,1/3],[1/4,0]\n\t\t\t\t]:[\n\t\t\t\t\t[1,1],[1,0],[0,0],[0,1],\n\t\t\t\t\t[0,1],[0,0],[1,0],[1,1],\n\t\t\t\t\t[0,1],[0,0],[1,0],[1,1],\n\t\t\t\t\t[1,1],[1,0],[0,0],[0,1],\n\t\t\t\t\t[1,0],[1,1],[0,1],[0,0],\n\t\t\t\t\t[1,1],[1,0],[0,0],[0,1]\n\t\t\t\t]\n\t\t\t\ts = (ninv>0)?[\n\t\t\t\t\t[3,1,0],[2,1,3],\n\t\t\t\t\t[4,5,7],[7,5,6],\n\t\t\t\t\t[8,9,11],[11,9,10],\n\t\t\t\t\t[15,13,12],[14,13,15],\t\n\t\t\t\t\t[16,17,19],[19,17,18],\n\t\t\t\t\t[23,21,20],[22,21,23],\t\t\n\t\t\t\t]:[\n\t\t\t\t\t[0,1,3],[3,1,2],\n\t\t\t\t\t[7,5,4],[6,5,7],\n\t\t\t\t\t[11,9,8],[10,9,11],\n\t\t\t\t\t[12,13,15],[15,13,14],\t\n\t\t\t\t\t[19,17,16],[18,17,19],\n\t\t\t\t\t[20,21,23],[23,21,22],\t\t\n\t\t\t\t]\n\t\t\t\tbreak ;\n\t\t\tcase \"mesh\":\n\t\t\t\tthis.parametricModel( function(u,v) {\n\t\t\t\t\tlet r = {\n\t\t\t\t\t\tpx:(u-0.5)*wx, py:0, pz:(v-0.5)*wz,\n\t\t\t\t\t\tnx:0, ny:1, nz:0,\n\t\t\t\t\t\tmu:u, mv:v }\n\t\t\t\t\treturn r ;\n\t\t\t\t},{start:1.0,end:0,div:divx},{start:0,end:1,div:divz},{ninv:param.ninv}) ;\n\t\t\t\treturn this ;\t\t\n\t\t\t\tbreak ;\n\t\t\tcase \"torus\":\n\t\t\t\tthis.parametricModel( function(u,v) {\n\t\t\t\t\tlet R = 1.0 ;\n\t\t\t\t\tlet sr = (param.sr)?param.sr:0.5 ;\n\t\t\t\t\tlet du = u ;\n\t\t\t\t\tlet dv = -v ;\n\t\t\t\t\tlet cx = Math.sin(du*PHI) ;\n\t\t\t\t\tlet cz = Math.cos(du*PHI) ;\n\t\t\t\t\tlet vx = Math.sin(dv*PHI) ;\n\t\t\t\t\tlet vy = Math.cos(dv*PHI) ;\n\t\t\t\t\tlet tx = 1\n\t\t\t\t\tlet mx = sr*vx*cx ;\n\t\t\t\t\tlet mz = sr*vx*cz ;\n\t\t\t\t\tlet my = sr*vy ;\n\t\t\t\t\tlet ml = Math.hypot(mx,my,mz) ;\n\t\t\t\n\t\t\t\t\tlet px = R*cx + tx*mx ;\n\t\t\t\t\tlet pz = R*cz + tx*mz ;\n\t\t\t\t\tlet py = tx*my ;\n\t\t\t\t\tlet r = {\n\t\t\t\t\t\tpx:px*wx, py:py*wy, pz:pz*wz,\n\t\t\t\t\t\tnx:0, ny:0, nz:0,\n\t\t\t\t\t\tmu:u, mv:v }\n\t\t\t\t\treturn r ;\t\t\t\n\t\t\t\t\t\n\t\t\t\t},{start:0,end:1.0,div:divx*2},{start:0,end:1,div:divy},{ninv:param.ninv}) ;\n\t\t\t\treturn this ;\n\t\t\tcase \"polyhedron\":\n\n\t\t\t\tif(!m[param.shape]) return null ;\n\t\t\t\tlet vt = m[param.shape].v ;\n\t\t\t\tlet si = m[param.shape].s ;\n\t\t\t\tlet vi = 0 ;\n\t\t\t\tfor(let i =0;i<si.length;i++) {\n\t\t\t\t\tlet nx=0,ny=0,nz=0 ;\n\t\t\t\t\tlet vs = [] ;\n\t\t\t\t\tfor(let h = si[i].length-1 ;h>=0;h--) {\n\t\t\t\t\t\tlet v = vt[si[i][h]] ;\n\t\t\t\t\t\tp.push([v[0],v[2],v[1]]) ;\n\t\t\t\t\t\tnx += v[0] ;\n\t\t\t\t\t\tny += v[2] ;\n\t\t\t\t\t\tnz += v[1] ;\n\t\t\t\t\t\tvs.push(vi) ;\n\t\t\t\t\t\tvi++ ;\n\t\t\t\t\t}\n\t\t\t\t\tlet vl = Math.hypot(nx,ny,nz) ;\n\t\t\t\t\tfor(let h = 0 ;h <si[i].length;h++) n.push([nx/vl,ny/vl,nz/vl]) ;\n\t\t\t\t\ts.push(vs) ;\n\t\t\t\t}\n\t\t\t\tt = null ;\n\t\t\t\tbreak ;\n\t\t\tcase \"icosa\":\n\t\t\t\tvt = m[\"r05\"].v ;\n\t\t\t\tsi = m[\"r05\"].s ;\n\t\t\t\tfor(let i=0;i<vt.length;i++) {\n\t\t\t\t\tlet vv = [vt[i][0],vt[i][2],vt[i][1]]\n\t\t\t\t\tp.push(vv)\n\t\t\t\t\tn.push(vv)\n\t\t\t\t\t_uv(vv)\n\t\t\t\t}\n\t\t\t\tfor(let i=0;i<si.length;i++) {\n\t\t\t\t\tif(ninv<0) s.push([si[i][0],si[i][1],si[i][2]])\n\t\t\t\t\telse  s.push([si[i][0],si[i][2],si[i][1]])\n\t\t\t\t}\n\t\t\t\tconst id = (param.div!==undefined)?param.div:2\n\t\t\t\tfor(let i=0;i<id;i++) tridiv(p,s) \n\t\t\t\tfor(let i=0;i<p.length;i++) {\n\t\t\t\t\tp[i][0] *= wx ;\n\t\t\t\t\tp[i][1] *= wy ;\n\t\t\t\t\tp[i][2] *= wz ;\n\t\t\t\t}\n\t\t\t\tbreak \n\t\t\t}\n\t\t\tfunction _uv(p) {\n\t\t\t\tlet u = Math.atan2(p[2],p[0])/Math.PI/2\n\t\t//\t\tif(u<0) u = 1-u\n\t\t\t\tt.push([(1-u)%1,1-Math.acos(p[1])/Math.PI])\n\t\t\t}\n\t\t\tfunction tridiv(v,s) {\n\t\t\t\tlet vi = v.length ;\n\t\t\t\tlet si = s.length ;\n\t\t\t\tlet vf ={} \n\t\t\t\tlet ret \n\t\t\t\tfunction _vff(i1,i2,ni) {\n\t\t\t\t\tlet k = (i1<i2)?`${i1}-${i2}`:`${i2}-${i1}`\n\t\t\t\t\tif(vf[k]==undefined) {\n\t\t\t\t\t\tvf[k] = ni\n\t\t\t\t\t\tret = ni  \n\t\t\t\t\t} else ret = vf[k]\n\t\t\t\t\treturn ret \n\t\t\t\t}\n\t\t\t\tfor(let i=0;i<si;i++) {\n\t\t\t\t\tlet i1 = s[i][0],i2 = s[i][1],i3 = s[i][2]\n\t\t\t\t\tlet v1 = v[i1], v2 = v[i2], v3 = v[i3]\n\n\t\t\t\t\tlet v12 = CanvasMatrix4.V3norm(CanvasMatrix4.V3add(v1,v2)) ;\n\t\t\t\t\tlet v23 = CanvasMatrix4.V3norm(CanvasMatrix4.V3add(v2,v3)) ;\n\t\t\t\t\tlet v31 = CanvasMatrix4.V3norm(CanvasMatrix4.V3add(v3,v1)) ;\n\t\t\t\t\tv.push(v12);\tv.push(v23);v.push(v31)\n\t\t\t\t\tn.push(v12);\tn.push(v23);n.push(v31)\n\t\t\t\t\t_uv(v12);_uv(v23);_uv(v31)\n\t\t\t\t\t\n\t\t\t\t\ts[i]=[i1,vi,vi+2] ;\n\t\t\t\t\ts.push([vi,vi+1,vi+2]) ;\n\t\t\t\t\ts.push([i2,vi+1,vi]) ;\n\t\t\t\t\ts.push([i3,vi+2,vi+1]) ;\n\t\t\t\t\tvi += 3\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.obj_v = p \n\t\t\tthis.obj_n = n\n\t\t\tthis.obj_t = t\n\t\t\tthis.obj_i = s\n\t\t//\tconsole.log(p)\n\t\t//\tconsole.log(n)\n\t\t//\tconsole.log(t)\n\t\t//\tconsole.log(s)\n\t\t\treturn this ;\n\t\t}\n\t\t// generate parametric model by function\n\t\t parametricModel(func,pu,pv,opt) {\n\t\t\tlet pos = [] ;\n\t\t\tlet norm = [] ;\n\t\t\tlet uv = [] ;\n\t\t\tlet indices = [] ;\n\t\t\tlet ninv = (opt && opt.ninv)?-1:1 ;\n\n\t\t\tlet du = (pu.end - pu.start)/pu.div ;\n\t\t\tlet dv = (pv.end - pv.start)/pv.div ;\n\t\t\tfor(let iu =0; iu <= pu.div ;iu++ ) {\n\t\t\t\tfor(let iv = 0 ;iv<= pv.div; iv++ ) {\n\t\t\t\t\tlet u = pu.start+du*iu ;\n\t\t\t\t\tlet v = pv.start+dv*iv ;\n\t\t\t\t\tlet p = func(u,v) ;\n\t\t\t\t\tpos.push( [p.px,p.py,p.pz] ) ;\n\t\t\t\t\tif(p.mu!=undefined) uv.push([p.mu,p.mv]) ;\n\t\t\t\t\t// calc normal\n\t\t\t\t\tif(p.nx==0&&p.ny==0&&p.nz==0) {\n\t\t\t\t\t\tlet dud = du/10 ; let dvd = dv/10 ;\n\t\t\t\t\t\tlet du0 = func(u-dud,v) ; let du1 = func(u+dud,v) ;\n\t\t\t\t\t\tlet nux = (du1.px - du0.px)/(dud*2) ;\n\t\t\t\t\t\tlet nuy = (du1.py - du0.py)/(dud*2) ;\n\t\t\t\t\t\tlet nuz = (du1.pz - du0.pz)/(dud*2) ;\n\t\t\t\t\t\tlet dv0 = func(u,v-dvd) ; let dv1 = func(u,v+dvd) ;\n\t\t\t\t\t\tlet nvx = (dv1.px - dv0.px)/(dvd*2) ;\n\t\t\t\t\t\tlet nvy = (dv1.py - dv0.py)/(dvd*2) ;\n\t\t\t\t\t\tlet nvz = (dv1.pz - dv0.pz)/(dvd*2) ;\n\t\t\t\t\t\tlet nx = nuy*nvz - nuz*nvy ;\n\t\t\t\t\t\tlet ny = nuz*nvx - nux*nvz ;\n\t\t\t\t\t\tlet nz = nux*nvy - nuy*nvx ;\n\t\t\t\t\t\tlet nl = Math.hypot(nx,ny,nz); \n\t\t\t\t\t\tp.nx = nx/nl ;\n\t\t\t\t\t\tp.ny = ny/nl ;\n\t\t\t\t\t\tp.nz = nz/nl ;\n\t\t\t\t\t}\n\t\t\t\t\tnorm.push([p.nx*ninv, p.ny*ninv,p.nz*ninv] ) ;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet d2 = pv.div+1 ;\n\t\t\tfor(let j = 0 ; j < pu.div ; ++j) {\n\t\t\t\tlet base = j * d2;\n\t\t\t\tfor(let i = 0 ; i < pv.div ; ++i) {\n\t\t\t\t\tif(ninv>0) indices.push([base+i,base+i+d2,base+i+d2+1,base+i+1])\t\n\t\t\t\t\telse  indices.push([base+i+1,base+i+d2+1,base+i+d2,base+i])\t\n\t\t\t\t}\t\n\n\t\t\t}\n\t\t\tthis.obj_v = pos\n\t\t\tthis.obj_n = norm\n\t\t\tif(uv.length>0) this.obj_t = uv\n\t\t\tthis.obj_i = indices \n\t\t\treturn this ;\n\t\t}\n\n\t\t//convert vtx data to vbo array\n\t\tobjModel(addvec,mode) {\n\t\t\tlet v = this.obj_v ;\n\t\t\tlet s = this.obj_i ;\n\t\t\tlet n = this.obj_n ;\n\t\t\tlet t = this.obj_t ;\n\t\t\tlet c = this.obj_c ;\n\n\t\t\tlet vbuf = [] ;\n\t\t\tlet ibuf = [] ;\n\t\t\tlet sf = [] ;\n\t\t\tlet sn = [] ;\n\t\t\tlet ii = 0 ;\n\t\t\tif(!n) this.obj_n = [] ;\n\n\t\t\tfor(let i=0,l=s.length;i<l;i++) {\n\t\t\t\tlet p = s[i] ;\n\t\t\t\tif(!n) {\n\t\t\t\t\t//\n\t\t\t\t\tlet pa = [] ;\n\t\t\t\t\tfor(let j=0;j<3;j++) {\n\t\t\t\t\t\tpa[j] = v[p[j]] ;\n\t\t\t\t\t}\n\t\t\t\t\tlet yx = pa[1][0]-pa[0][0];\n\t\t\t\t\tlet yy = pa[1][1]-pa[0][1];\n\t\t\t\t\tlet yz = pa[1][2]-pa[0][2];\n\t\t\t\t\tlet zx = pa[2][0]-pa[0][0];\n\t\t\t\t\tlet zy = pa[2][1]-pa[0][1];\n\t\t\t\t\tlet zz = pa[2][2]-pa[0][2];\t\t\t\t\n\t\t\t\t\tlet xx =  yy * zz - yz * zy;\n\t\t\t\t\tlet xy = -yx * zz + yz * zx;\n\t\t\t\t\tlet xz =  yx * zy - yy * zx;\n\t\t\t\t\tlet vn = Math.hypot(xx,xy,xz) ;\n\t\t\t\t\txx /= vn ; xy /= vn ; xz /= vn ;\n\t\t\t\t\tsf.push( [xx,xy,xz]) ;\n\t\t\t\t\t//\n\t\t\t\t\tfor(let j=0,lj=p.length;j<lj;j++) {\n\t\t\t\t\t\tif(!sn[p[j]]) sn[p[j]] = [] ;\n\t\t\t\t\t\tsn[p[j]].push(i) ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//3\n\t\t\t\tfor(let j=1,lj=p.length-1;j<lj;j++) {\n\t\t\t\t\tibuf.push(p[0]) ;\n\t\t\t\t\tibuf.push(p[j]) ;\n\t\t\t\t\tibuf.push(p[j+1] ) ;\n\t\t\t\t}\n\t\t\t\tii += p.length ;\n\t\t\t}\n\t\t\tconsole.log(\" vert:\"+v.length);\n\t\t\tconsole.log(\" poly:\"+ibuf.length/3);\n\t\t\tfor(let i=0,l=v.length;i<l;i++) {\n\t\t\t\tvbuf.push( parseFloat( v[i][0]) ) ;\n\t\t\t\tvbuf.push( parseFloat( v[i][1]) ) ;\n\t\t\t\tvbuf.push( parseFloat( v[i][2]) ) ;\n\t\t\t\tlet nx=0,ny=0,nz=0 ;\t\t\n\t\t\t\tif(n) {\n\t\t\t\t\tnx = n[i][0] ;\n\t\t\t\t\tny = n[i][1] ;\n\t\t\t\t\tnz = n[i][2] ;\n\t\t\t\t} else {\n\t\t\t\t\t//\n\t\t\t\t\tfor(let j=0;j<sn[i].length;j++) {\n\t\t\t\t\t\tlet ii = sn[i][j] ;\n\t\t\t\t\t\tnx += sf[ii][0] ;\n\t\t\t\t\t\tny += sf[ii][1] ;\n\t\t\t\t\t\tnz += sf[ii][2] ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet vn = Math.hypot(nx,ny,nz) ;\n\t\t\t\tif(vn==0) {\n\t\t\t\tvbuf.push(0) ;\n\t\t\t\tvbuf.push(0) ;\n\t\t\t\tvbuf.push(0) ;\t\t\t\n\t\t\t\t} else {\n\t\t\t\tvbuf.push(nx/vn) ;\n\t\t\t\tvbuf.push(ny/vn) ;\n\t\t\t\tvbuf.push(nz/vn) ;\n\t\t\t\t}\n\t\t\t\tif(!n) {\n\t\t\t\t\tthis.obj_n.push([nx/vn,ny/vn,nz/vn]); \n\t\t\t\t}\n\t\t\t\tif(t) {\n\t\t\t\t\tvbuf.push(parseFloat( t[i][0]) ) ;\n\t\t\t\t\tvbuf.push(parseFloat( t[i][1]))  ;\n\t\t\t\t}\n\t\t\t\tif(c) {\n\t\t\t\t\tvbuf.push(parseFloat( c[i][0])) ;\n\t\t\t\t\tvbuf.push(parseFloat( c[i][1])) ;\n\t\t\t\t\tvbuf.push(parseFloat( c[i][2])) ;\n\t\t\t\t}\n\t\t\t\tif(addvec) {\n\t\t\t\t\tfor(av=0;av<addvec.length;av++) {\n\t\t\t\t\t\tvbuf = vbuf.concat(addvec[av].data[i]) ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t//\tconsole.log(vbuf) ;\n\t\t//\tconsole.log(ibuf) ;\n\t\t\tthis.ibuf = ibuf ;\n\t\t\tthis.vbuf = vbuf ;\n\t\t\tlet ret = {mode:\"tri\",vtx_at:[\"position\",\"norm\"],vtx:vbuf,idx:ibuf} ;\n\t\t\tif(t) ret.vtx_at.push(\"uv\") ;\n\t\t\tif(c) ret.vtx_at.push(\"color\") ;\n\t\t\tif(addvec) {\n\t\t\t\tfor(av=0;av<addvec.length;av++) ret.vtx_at.push(addvec[av].attr) ;\n\t\t\t}\n\t\t\treturn ret ;\n\t\t}\n\n\t\t// generate normal vector lines\n\t\t normLines(vm) {\n\t\t\tlet nv = [] ;\n\t\t\tlet v = this.obj_v\n\t\t\tlet n = this.obj_n ;\n\t\t\tif(vm==undefined) vm = 0.1\n\t\t\tfor(let i=0,l=v.length;i<l;i++) {\n\t\t\t\tnv.push(v[i][0]) ;\n\t\t\t\tnv.push(v[i][1]) ;\n\t\t\t\tnv.push(v[i][2]) ;\n\t\t\t\tnv.push(v[i][0]+n[i][0]*vm) ;\n\t\t\t\tnv.push(v[i][1]+n[i][1]*vm) ;\n\t\t\t\tnv.push(v[i][2]+n[i][2]*vm) ;\n\t\t\t}\n\t\t\treturn  {mode:\"lines\",vtx_at:[\"position\"],vtx:nv} ;\n\t\t}\n\t\t// generate wireframe lines\n\t\t wireframe() {\n\t\t\tlet nv = [] ;\n\t\t\tlet v = this.obj_v ;\n\t\t\tlet s = this.obj_i ;\n\t\t\tfor(let k=0,l=s.length;k<l;k++) {\n\t\t\t\tlet ss = s[k]; \n\t\t\t\tlet i\n\t\t\t\tfor(i=1;i<ss.length;i++) {\n\t\t\t\t\tnv.push(v[ss[i-1]][0]) ;\n\t\t\t\t\tnv.push(v[ss[i-1]][1]) ;\n\t\t\t\t\tnv.push(v[ss[i-1]][2]) ;\n\t\t\t\t\tnv.push(v[ss[i]][0]) ;\n\t\t\t\t\tnv.push(v[ss[i]][1]) ;\n\t\t\t\t\tnv.push(v[ss[i]][2]) ;\n\t\t\t\t}\n\t\t\t\tnv.push(v[ss[i-1]][0]) ;\n\t\t\t\tnv.push(v[ss[i-1]][1]) ;\n\t\t\t\tnv.push(v[ss[i-1]][2]) ;\t\t\n\t\t\t\tnv.push(v[ss[0]][0]) ;\n\t\t\t\tnv.push(v[ss[0]][1]) ;\n\t\t\t\tnv.push(v[ss[0]][2]) ;\t\n\t\t\t}\n\t\t\treturn  {mode:\"lines\",vtx_at:[\"position\"],vtx:nv} ;\t\n\t\t}\n\n\t\t// mult 4x4 matrix to model\n\t\t multMatrix4(m4) {\n\t\t\tlet inv = new CanvasMatrix4(m4).invert().transpose() ;\n\t\t\tlet buf = m4.getAsArray()\n\t\t\tfor(let i=0;i<this.obj_v.length;i++) {\n\t\t\t\tlet v = this.obj_v[i] ;\n\t\t\t\tlet vx = buf[0] * v[0] + buf[4] * v[1] + buf[8] * v[2] + buf[12] ;\n\t\t\t\tlet vy = buf[1] * v[0] + buf[5] * v[1] + buf[9] * v[2] + buf[13] ;\n\t\t\t\tlet vz = buf[2] * v[0] + buf[6] * v[1] + buf[10] * v[2] + buf[14] ;\n\t\t\t\tthis.obj_v[i] = [vx,vy,vz] ;\n\t\t\t}\n\t\t\tbuf = inv.getAsArray() \n\t\t\tfor(let i=0;i<this.obj_n.length;i++) {\n\t\t\t\tlet v = this.obj_n[i] ;\n\t\t\t\tlet vx = buf[0] * v[0] + buf[4] * v[1] + buf[8] * v[2] + buf[12] ;\n\t\t\t\tlet vy = buf[1] * v[0] + buf[5] * v[1] + buf[9] * v[2] + buf[13] ;\n\t\t\t\tlet vz = buf[2] * v[0] + buf[6] * v[1] + buf[10] * v[2] + buf[14] ;\n\t\t\t\tthis.obj_n[i] = [vx,vy,vz] ;\n\t\t\t}\n\t\t}\n\t\t// merge model\n\t\t mergeModels(models) {\n\t\t\tlet m = this ;\n\t\t\tlet ofs = 0 ;\n\t\t\tfor(let i=0;i<models.length;i++) {\n\t\t\t\tm.obj_v = m.obj_v.concat(models[i].obj_v) \n\t\t\t\tm.obj_n = m.obj_n.concat(models[i].obj_n) \n\t\t\t\tm.obj_t = m.obj_t.concat(models[i].obj_t)\n\t\t\t\tfor(let j=0;j<models[i].obj_i.length;j++) {\n\t\t\t\t\tlet p = models[i].obj_i[j] ;\n\t\t\t\t\tlet pp = [] ;\n\t\t\t\t\tfor( n=0;n<p.length;n++) {\n\t\t\t\t\t\tpp.push( p[n]+ofs ) ;\n\t\t\t\t\t}\n\t\t\t\t\tm.obj_i.push(pp) ;\n\t\t\t\t}\n\t\t\t\tofs += models[i].obj_v.length ;\n\t\t\t}\n\t\t\treturn m ;\n\t\t}\n\t\t// calc bounding box \n\t\tboundbox() {\n\t\t\tlet sx = Number.MAX_VALUE\n\t\t\tlet sy = sx \n\t\t\tlet sz = sx \n\t\t\tlet ex = Number.MIN_VALUE \n\t\t\tlet ey = ex \n\t\t\tlet ez = ex \n\t\t\t\n\t\t\tfor(let i=0;i<this.obj_v.length;i++) {\n\t\t\t\tlet v = this.obj_v[i] ;\t\n\t\t\t\tif( v[0] < sx ) sx = v[0]\n\t\t\t\tif( v[1] < sy ) sy = v[1] \n\t\t\t\tif( v[2] < sz ) sz = v[2] \n\t\t\t\tif( v[0] > ex ) ex = v[0] \n\t\t\t\tif( v[1] > ey ) ey = v[1] \n\t\t\t\tif( v[2] > ez ) ez = v[2] \n\t\t\t}\n\t\t\treturn [[sx,sy,sz],[ex,ey,ez]]\n\t\t}\n\n\t\t// load external file \n\t\tloadAjax(src) {\n\t\t\treturn new Promise(function(resolve,reject) {\n\t\t\t\tlet req = new XMLHttpRequest();\n\t\t\t\treq.open(\"get\",src,true) ;\n\t\t\t\treq.responseType = \"text\" ;\n\t\t\t\treq.onload = function() {\n\t\t\t\t\tif(this.status==200) {\n\t\t\t\t\t\tresolve(this.response) ;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(\"Ajax error:\"+this.statusText) ;\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treq.onerror = function() {\n\t\t\t\t\treject(\"Ajax error:\"+this.statusText)\n\t\t\t\t}\n\t\t\t\treq.send() ;\n\t\t\t})\n\t\t}\n\t\tstatic loadLines(path,cb,lbufsize) {\n\t\t\tif(!lbufsize) lbufsize = 10000\n\t\t\tconst decoder = new TextDecoder\n\t\t\treturn new Promise((resolve,reject)=>{\n\t\t\t\tfetch( path , {\n\t\t\t\t\tmethod:\"GET\"\n\t\t\t\t}).then( async resp=>{\n\t\t\t\t\tif(resp.ok) {\n\t\t\t\t\t\tconst reader = resp.body.getReader();\n\t\t\t\t\t\tconst buf = new Uint8Array(lbufsize)\n\t\t\t\t\t\tlet bi = 0 \n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\tconst {done, value} = await reader.read();\n\t\t\t\t\t\t\tif (done) {\n\t\t\t\t\t\t\t  cb(decoder.decode(buf.slice(0,bi))) \n\t\t\t\t\t\t\t  resolve(resp)\n\t\t\t\t\t\t\t  break;\n\t\t\t\t\t\t\t}\n\t\t//\t\t\t\t\tconsole.log(value.length)\n\t\t\t\t\t\t\tfor (const char of value) {\n\t\t\t\t\t\t\t\tbuf[bi++] = char \n\t\t\t\t\t\t\t\tif(char == 0x0a ) {\n\t\t\t\t\t\t\t\t\tcb(decoder.decode(buf.slice(0,bi-1))) \n\t\t\t\t\t\t\t\t\tbi = 0 \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(resp)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t\t// load .obj file\n\t\tasync loadObj(path,scale) {\n\t\t\tif(!scale) scale=1.0 ;\n\t\t\treturn new Promise((resolve,reject)=> {\n\t\t\t\tthis.loadAjax(path).then((data)=> {\n\t\t//\t\t\tconsole.log(data) ;\n\t\t\t\t\tlet l = data.split(\"\\n\") ;\n\t\t\t\t\tlet v = [];\n\t\t\t\t\tlet n = [] ;\n\t\t\t\t\tlet x = [] ;\n\t\t\t\t\tlet t = [] ;\n\t\t\t\t\tlet c = [] ;\n\t\t\t\t\tlet xi = {} ;\n\t\t\t\t\tlet xic = 0 ;\n\n\t\t\t\t\tfor(let i = 0,len=l.length;i<len;i++) {\n\t\t\t\t\t\tif(l[i].match(/^#/)) continue ;\n\t\t\t\t\t\tif(l[i].match(/^eof/)) break ;\n\t\t\t\t\t\tlet ll = l[i].split(/\\s+/) ;\n\t\t\t\t\t\tif(ll[0] == \"v\") {\n\t\t\t\t\t\t\tv.push([ll[1]*scale,ll[2]*scale,ll[3]*scale]) ;\n\t\t\t\t\t\t\tif(ll.length==7) c.push([ll[4],ll[5],ll[6]])\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ll[0] == \"vt\") {\n\t\t\t\t\t\t\tt.push([ll[1],ll[2]]) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ll[0] == \"vn\") {\n\t\t\t\t\t\t\tn.push([ll[1],ll[2],ll[3]]) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ll[0] == \"f\") {\n\t\t\t\t\t\t\tlet ix = [] ;\n\t\t\t\t\t\t\tfor(let ii=1;ii<ll.length;ii++) {\n\t\t\t\t\t\t\t\tif(ll[ii]==\"\") continue ;\n\t\t\t\t\t\t\t\tif(!(ll[ii] in xi)) xi[ll[ii]] = xic++ ; \n\t\t\t\t\t\t\t\tix.push(xi[ll[ii]]) ;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tx.push(ix) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.obj_v = [] ;\n\t\t\t\t\tif(c.length>0) this.obj_c = [] \n\t\t\t\t\tthis.obj_i =x ;\n\t\t\t\t\tif(n.length>0) this.obj_n = [] ;\n\t\t\t\t\tif(t.length>0) this.obj_t = [] ;\n\t\t\t\t\tif(x.length>0) {\n\t\t\t\t\t\tfor(let i in xi) {\n\t\t\t\t\t\t\tlet si = i.split(\"/\") ;\n\t\t\t\t\t\t\tlet ind = xi[i] ;\n\t\t\t\t\t\t\tthis.obj_v[ind] = v[si[0]-1] ;\n\t\t\t\t\t\t\tif(c.length>0) this.obj_c[ind] = c[si[0]-1]  \n\t\t\t\t\t\t\tif(t.length>0) this.obj_t[ind] = t[si[1]-1] ;\n\t\t\t\t\t\t\tif(n.length>0) this.obj_n[ind] = n[si[2]-1] ;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.obj_v = v \n\t\t\t\t\t\tif(c.length>0) this.obj_c = c\n\t\t\t\t\t\tif(n.length>0) this.obj_n = n\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(\"loadobj \"+path+\" vtx:\"+v.length+\" norm:\"+n.length+\" tex:\"+t.length+\" idx:\"+x.length+\" vbuf:\"+this.obj_v.length) ;\n\t\t\t\t\tresolve(this) ;\n\t\t\t\t}).catch(function(err) {\n\t\t\t\t\treject(err) ;\n\t\t\t\t})\n\t\t\t}) ;\n\t\t}\n\t\tstatic async loadObj2(path,opt) {\n\n\t\t\tlet scale = 1.0\n\t\t\tlet zup = false  \n\t\t\tlet nogroup = false \n\t\t\tlet nomtl = false \n\t\t\tif(opt) {\n\t\t\t\tif(opt.scale) scale=opt.scale\n\t\t\t\tif(opt.zup) zup = opt.zup\n\t\t\t\tif(opt.nogroup) nogroup = opt.nogroup\n\t\t\t\tif(opt.nomtl) nomtl = opt.nomtl\n\t\t\t}\n\t\t\treturn new Promise((resolve,reject)=> {\n\t\t\t\tconst v = [];\n\t\t\t\tconst n = [] ;\n\t\t\t\tconst xl = {} ;\n\t\t\t\tconst t = [] ;\n\t\t\t\tconst c = [] ;\n\t\t\t\tconst xi = {} ;\n\t\t\t\tconst rxi = []\n\t\t\t\tlet xic = 0 ;\n\t\t\t\tlet usemtl = \"\" \n\t\t\t\tlet group = \"\" \n\t\t\t\tconst pmtls = []\n\t\t\t\tconst mtlspath = [] \n\t\t\t\tWWModel.loadLines(path,async l=>{\n\t\t\t\t\t\tif(l.match(/^#/)) return ;\n\t\t\t\t\t\tif(l.match(/^eof/)) return ;\n\t\t\t\t\t\tconst ll = l.split(/\\s+/) ;\n\t\t\t\t\t\tconst cmd = ll[0]\n\t\t\t\t\t\tif(cmd == \"v\") {\n\t\t\t\t\t\t\tif(zup) v.push([ll[1]*scale,ll[3]*scale,-ll[2]*scale]) ;\n\t\t\t\t\t\t\telse v.push([ll[1]*scale,ll[2]*scale,ll[3]*scale]) ;\n\t\t\t\t\t\t\tif(ll.length==7) c.push([ll[4],ll[5],ll[6]])\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cmd == \"vt\") {\n\t\t\t\t\t\t\tt.push([ll[1],ll[2]]) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cmd == \"vn\") {\n\t\t\t\t\t\t\tif(zup) n.push([ll[1],ll[3],-ll[2]]) ;\n\t\t\t\t\t\t\telse  n.push([ll[1],ll[2],ll[3]]) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cmd == \"f\") {\n\t\t\t\t\t\t\tlet ix = [] ;\n\t\t\t\t\t\t\tfor(let ii=1;ii<ll.length;ii++) {\n\t\t\t\t\t\t\t\tif(ll[ii]==\"\") continue ;\n\t\t\t\t\t\t\t\tif(!(ll[ii] in xi)) {\n\t\t\t\t\t\t\t\t\txi[ll[ii]] = xic++ ; \n\t\t\t\t\t\t\t\t\trxi[xi[ll[ii]]] = ll[ii]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tix.push(xi[ll[ii]]) ;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(!xl[group]) xl[group] = {} \n\t\t\t\t\t\t\tif(!xl[group][usemtl]) xl[group][usemtl] = []\n\t\t\t\t\t\t\txl[group][usemtl].push(ix) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cmd == \"mtllib\") {\n\t\t\t\t\t\t\tlet pp = path.split(\"/\") \n\t\t\t\t\t\t\tpp[pp.length-1] = ll[1] \n\t\t\t\t\t\t\tpmtls.push( WWModel.loadMtl(pp.join(\"/\")) )\n\t\t\t\t\t\t\tmtlspath.push(pp)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cmd == \"usemtl\") {\n\t\t\t\t\t\t\tif(!nomtl) usemtl = ll[1] \n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cmd == \"g\") {\n\t\t\t\t\t\t\tif(!nogroup) group = ll[1] \n\t\t\t\t\t\t}\n\t\t\t\t}).then(r=>{\n\t\t\t\t\tconst groups = []\n\t\t\t\t\tlet objs\n\t\t\t\t\tconsole.log(xl)\n\t\t\t\t\tconsole.log(rxi)\n\t\t\t\t\tfor(let g in xl) {\n\t\t\t\t\t\tobjs = [] \n\t\t\t\t\t\tfor( let m in xl[g]) {\n\t\t\t\t\t\t\tlet x = xl[g][m]\n\t\t\t\t\t\t\tconst obj = new WWModel() \n\t\t\t\t\t\t\tobj.obj_v = [] ;\n\t\t\t\t\t\t\tif(c.length>0) obj.obj_c = [] \n\t\t\t\t\t\t\tif(n.length>0) obj.obj_n = [] ;\n\t\t\t\t\t\t\tif(t.length>0) obj.obj_t = [] ;\n\t\t\t\t\t\t\tobj.obj_i =x ;\n\t\t\t\t\t\t\tif(x.length>0) {\n\t\t\t\t\t\t\t\tfor(let i in xi) {\n\t\t\t\t\t\t\t\t\tlet si = i.split(\"/\") ;\n\t\t\t\t\t\t\t\t\tlet ind = xi[i] ;\n\t\t\t\t\t\t\t\t\tobj.obj_v[ind] = v[si[0]-1] ;\n\t\t\t\t\t\t\t\t\tif(c.length>0) obj.obj_c[ind] = c[si[0]-1]  \n\t\t\t\t\t\t\t\t\tif(t.length>0) obj.obj_t[ind] = t[si[1]-1] ;\n\t\t\t\t\t\t\t\t\tif(n.length>0) obj.obj_n[ind] = n[si[2]-1] ;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tobj.obj_v = v \n\t\t\t\t\t\t\t\tif(c.length>0) obj.obj_c = c\n\t\t\t\t\t\t\t\tif(n.length>0) obj.obj_n = n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobjs.push({obj:obj,mtlname:m})\n\t\t\t\t\t\t\tconsole.log(\"loadobj \"+path+\" vtx:\"+v.length+\" norm:\"+n.length+\" tex:\"+t.length+\" idx:\"+x.length+\" vbuf:\"+obj.obj_v.length) ;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgroups.push({objs:objs,group:g})\n\t\t\t\t\t}\n\t\t\t\t\tif(pmtls.length>0) {\n\t\t\t\t\t\tPromise.all(pmtls).then(mtls=> {\n\t\t\t\t\t\t\tlet allmtls = {} \n\t\t\t\t\t\t\tfor(let i in mtls) {\n\t\t\t\t\t\t\t\tallmtls = Object.assign(allmtls,mtls[i]) \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve((nogroup)?{objs:objs,mtls:allmtls}:{groups:groups,mtls:allmtls})\n\t\t\t\t\t\t})\n\t\t\t\t\t} else resolve((nogroup)?{objs:objs}:{groups:groups})\n\t\t\t\t\t\t\t\t\n\t\t\t\t}).catch(err=> {\n\t\t\t\t\treject(err) ;\n\t\t\t\t})\n\t\t\t}) ;\n\t\t}\n\t\tstatic async loadMtl(path) {\n\t\t\tconst mtls = []\n\t\t\tlet mtlname = \"\" \n\t\t\treturn new Promise((resolve,reject)=> {\n\t\t\t\tWWModel.loadLines(path,l=>{\n\t\t\t\t\tif(l.match(/^#/)) return \n\t\t\t\t\tif(l.match(/^eof/)) return \n\t\t\t\t\tconst ll = l.split(/\\s+/) \n\t\t\t\t\tconst cmd = ll[0]\n\t\t\t\t\tif(cmd==\"newmtl\") {\n\t\t\t\t\t\tmtlname = ll[1] \n\t\t\t\t\t\tmtls[mtlname] = {}\n\t\t\t\t\t\treturn  \n\t\t\t\t\t}\n\t\t\t\t\tswitch(cmd) {\n\t\t\t\t\t\tcase \"Kd\":\n\t\t\t\t\t\tcase \"Ks\":\n\t\t\t\t\t\tcase \"Ka\":\n\t\t\t\t\t\tcase \"Tf\":\n\t\t\t\t\t\t\tmtls[mtlname][cmd] = [parseFloat(ll[1]),parseFloat(ll[2]),parseFloat(ll[3])]\n\t\t\t\t\t\t\tbreak ;\n\t\t\t\t\t\tcase \"Ni\":\n\t\t\t\t\t\tcase \"d\":\n\t\t\t\t\t\tcase \"Ns\":\n\t\t\t\t\t\t\tmtls[mtlname][cmd] = parseFloat(ll[1])\n\t\t\t\t\t\t\tbreak ;\n\t\t\t\t\t\tcase \"illum\":\n\t\t\t\t\t\t\tmtls[mtlname][cmd] = parseInt(ll[1])\n\t\t\t\t\t\t\tbreak ;\n\t\t\t\t\t\tcase \"map_Kd\":\n\t\t\t\t\t\tcase \"map_Ka\":\n\t\t\t\t\t\tcase \"map_Ks\":\n\t\t\t\t\t\t\tmtls[mtlname][cmd] = ll[1]\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}).then(r=>{\n\t\t\t\t\tresolve(mtls) \n\t\t\t\t}).catch(err=> {\n\t\t\t\t\treject(err) ;\n\t\t\t\t})\t\t\t\n\t\t\t})\n\t\t}\n\n\n\t\t// other utils \n\t\tstatic  HSV2RGB( H, S, V ,a) {\n\t\t\tlet ih;\n\t\t\tlet fl;\n\t\t\tlet m, n;\n\t\t\tlet rr,gg,bb ;\n\t\t\tH = H * 6 ;\n\t\t\tih = Math.floor( H );\n\t\t\tfl = H - ih;\n\t\t\tif( !(ih & 1)) fl = 1 - fl;\n\t\t\tm = V * ( 1 - S );\n\t\t\tn = V * ( 1 - S * fl );\n\t\t\tswitch( ih ){\n\t\t\t\tcase 0:\n\t\t\t\tcase 6:\n\t\t\t\t\trr = V; gg = n; bb = m; break;\n\t\t\t\tcase 1: rr = n; gg = V; bb = m; break;\n\t\t\t\tcase 2: rr = m; gg = V; bb = n; break;\n\t\t\t\tcase 3: rr = m; gg = n; bb = V; break;\n\t\t\t\tcase 4: rr = n; gg = m; bb = V; break;\n\t\t\t\tcase 5: rr = V; gg = m; bb = n; break;\n\t\t\t}\n\t\t\treturn [rr,gg,bb,(a===undefined)?1.0:a] ;\n\t\t}\n\t\tstatic  snormal(pa) {\n\t\t\tlet yx = pa[1][0]-pa[0][0];\n\t\t\tlet yy = pa[1][1]-pa[0][1];\n\t\t\tlet yz = pa[1][2]-pa[0][2];\n\t\t\tlet zx = pa[2][0]-pa[0][0];\n\t\t\tlet zy = pa[2][1]-pa[0][1];\n\t\t\tlet zz = pa[2][2]-pa[0][2];\t\t\t\t\n\t\t\tlet xx =  yy * zz - yz * zy;\n\t\t\tlet xy = -yx * zz + yz * zx;\n\t\t\tlet xz =  yx * zy - yy * zx;\n\t\t\tlet vn = Math.hypot(xx,xy,xz) ;\n\t\t\txx /= vn ; xy /= vn ; xz /= vn ;\n\t\t\treturn [xx,xy,xz] ;\n\t\t}\n\n\t} //class WWModel\n\n\n\treturn pox.WWModel = WWModel;\n});\n\n"]}